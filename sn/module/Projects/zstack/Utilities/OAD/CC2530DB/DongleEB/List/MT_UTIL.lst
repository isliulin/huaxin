###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.40338/W32 for 8051         21/Jul/2014  12:20:05 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Comp #
#                          onents\mt\MT_UTIL.c                                #
#    Command line       =  -f D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\P #
#                          rojects\zstack\Utilities\OAD\CC2530DB\..\..\..\Too #
#                          ls\CC2530DB\f8wEndev.cfg (-DCPU32MHZ               #
#                          -DROOT=__near_func -DBLINK_LEDS) -f                #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\Tools\ #
#                          CC2530DB\f8wConfig.cfg (-DSECURE=0                 #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFF0                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Comp #
#                          onents\mt\MT_UTIL.c -D NWK_AUTO_POLL -D ZTOOL_P1   #
#                          -D MT_TASK -D MT_APP_FUNC -D MT_NWK_FUNC -D        #
#                          MT_NWK_CB_FUNC -D MT_SYS_FUNC -D MT_ZDO_FUNC -D    #
#                          MT_ZDO_CB_FUNC -D MT_UTIL_FUNC -D LCD_SUPPORTED    #
#                          -D RFD_RCVC_ALWAYS_ON -D ZPORT -D HOLD_AUTO_START  #
#                          -lC D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\ #
#                          Projects\zstack\Utilities\OAD\CC2530DB\DongleEB\Li #
#                          st\ -lA D:\WorkReserve\project\AES_BOOT\CC2530EncB #
#                          oot\Projects\zstack\Utilities\OAD\CC2530DB\DongleE #
#                          B\List\ -o D:\WorkReserve\project\AES_BOOT\CC2530E #
#                          ncBoot\Projects\zstack\Utilities\OAD\CC2530DB\Dong #
#                          leEB\Obj\ -e --debug --core=plain --dptr=16,1      #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\P #
#                          rojects\zstack\Utilities\OAD\CC2530DB\ -I          #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\SOURCE\ -I   #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\ZMAIN\ #
#                          TI2530DB\ -I D:\WorkReserve\project\AES_BOOT\CC253 #
#                          0EncBoot\Projects\zstack\Utilities\OAD\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\MT\ -I                     #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\HAL\INCLUDE\ -I                         #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\HAL\TARGET\CC2530EB\ -I                 #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\OSAL\INCLUDE\ -I                        #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\STACK\AF\ -I D:\WorkReserve\project\AES #
#                          _BOOT\CC2530EncBoot\Projects\zstack\Utilities\OAD\ #
#                          CC2530DB\..\..\..\..\..\COMPONENTS\STACK\NWK\ -I   #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\STACK\SEC\ -I                           #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\STACK\SAPI\ -I                          #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\STACK\SYS\ -I                           #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\STACK\ZDO\ -I                           #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\ZMAC\F8W\ -I D:\WorkReserve\project\AES #
#                          _BOOT\CC2530EncBoot\Projects\zstack\Utilities\OAD\ #
#                          CC2530DB\..\..\..\..\..\COMPONENTS\ZMAC\ -I        #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\SERVICES\SADDR\ -I                      #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\SERVICES\SDATA\ -I                      #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\MAC\INCLUDE\ -I                         #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\MAC\HIGH_LEVEL\ -I                      #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\MAC\LOW_LEVEL\srf04\ -I                 #
#                          D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\..\..\..\..\..\ #
#                          COMPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP\ -Ohz   #
#                          --require_prototypes                               #
#    List file          =  D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\DongleEB\List\M #
#                          T_UTIL.lst                                         #
#    Object file        =  D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Proj #
#                          ects\zstack\Utilities\OAD\CC2530DB\DongleEB\Obj\MT #
#                          _UTIL.r51                                          #
#                                                                             #
#                                                                             #
###############################################################################

D:\WorkReserve\project\AES_BOOT\CC2530EncBoot\Components\mt\MT_UTIL.c
      1          /***************************************************************************************************
      2            Filename:       MT_UTIL.c
      3            Revised:        $Date: 2009-12-29 18:31:22 -0800 (Tue, 29 Dec 2009) $
      4            Revision:       $Revision: 21416 $
      5          
      6            Description:    MonitorTest Utility Functions
      7          
      8            Copyright 2007 - 2009 Texas Instruments Incorporated. All rights reserved.
      9          
     10            IMPORTANT: Your use of this Software is limited to those specific rights
     11            granted under the terms of a software license agreement between the user
     12            who downloaded the software, his/her employer (which must be your employer)
     13            and Texas Instruments Incorporated (the "License").  You may not use this
     14            Software unless you agree to abide by the terms of the License. The License
     15            limits your use, and you acknowledge, that the Software may not be modified,
     16            copied or distributed unless embedded on a Texas Instruments microcontroller
     17            or used solely and exclusively in conjunction with a Texas Instruments radio
     18            frequency transceiver, which is integrated into your product.  Other than for
     19            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     20            works of, modify, distribute, perform, display or sell this Software and/or
     21            its documentation for any purpose.
     22          
     23            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     24            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     25            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     26            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     27            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     28            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     29            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     30            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     31            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     32            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     33            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     34          
     35            Should you have any questions regarding your right to use this Software,
     36            contact Texas Instruments Incorporated at www.TI.com.
     37          
     38           ***************************************************************************************************/
     39          
     40          /***************************************************************************************************
     41           * INCLUDES
     42           ***************************************************************************************************/
     43          #include "ZComDef.h"
     44          
     45          #include "AddrMgr.h"
     46          #include "AssocList.h"
     47          #include "OnBoard.h"   /* This is here because of the key reading */
     48          #include "hal_key.h"
     49          #include "hal_led.h"
     50          #include "OSAL_Nv.h"
     51          #include "NLMEDE.h"
     52          #include "ZDApp.h"
     53          #include "MT.h"
     54          #include "MT_UTIL.h"
     55          #include "MT_ZDO.h"
     56          #include "MT_SAPI.h"
     57          #include "MT_NWK.h"
     58          #include "MT_AF.h"
     59          #include "MT_MAC.h"
     60          #if defined ZCL_KEY_ESTABLISH
     61          #include "zcl_key_establish.h"
     62          #endif
     63          #if defined TC_LINKKEY_JOIN
     64          #include "zcl_se.h"
     65          #endif
     66          
     67          /***************************************************************************************************
     68           * CONSTANTS
     69           ***************************************************************************************************/
     70          #define MT_UTIL_DEVICE_INFO_RESPONSE_LEN 14
     71          
     72          /***************************************************************************************************
     73           * LOCAL VARIABLES
     74           ***************************************************************************************************/
     75          #if defined ZCL_KEY_ESTABLISH
     76          uint8 zcl_key_establish_task_id;
     77          #endif
     78          
     79          /***************************************************************************************************
     80           * LOCAL FUNCTIONS
     81           ***************************************************************************************************/
     82          #if defined (MT_UTIL_FUNC)
     83          void MT_UtilGetDeviceInfo(void);
     84          void MT_UtilGetNvInfo(void);
     85          void MT_UtilSetPanID(uint8 *pBuf);
     86          void MT_UtilSetChannels(uint8 *pBuf);
     87          void MT_UtilSetSecLevel(uint8 *pBuf);
     88          void MT_UtilSetPreCfgKey(uint8 *pBuf);
     89          void MT_UtilCallbackSub(uint8 *pData);
     90          void MT_UtilKeyEvent(uint8 *pBuf);
     91          void MT_UtilTimeAlive(void);
     92          void MT_UtilLedControl(uint8 *pBuf);
     93          static void MT_UtilAddrMgrExtAddrLookup(uint8 *pBuf);
     94          static void MT_UtilAddrMgrEntryLookupNwk(uint8 *pBuf);
     95          static void MT_UtilAPSME_LinkKeyDataGet(uint8 *pBuf);
     96          static void MT_UtilAssocCount(uint8 *pBuf);
     97          static void MT_UtilAssocFindDevice(uint8 *pBuf);
     98          static void MT_UtilAssocGetWithAddress(uint8 *pBuf);
     99          #if defined ZCL_KEY_ESTABLISH
    100          static void MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(uint8 *pBuf);
    101          static void MT_UtilzclGeneral_KeyEstablishment_ECDSASign(uint8 *pBuf);
    102          #endif
    103          static void MT_UtilSync(void);
    104          #endif /* MT_UTIL_FUNC */
    105          
    106          #if defined (MT_UTIL_FUNC)
    107          /***************************************************************************************************
    108           * @fn      MT_UtilProcessing
    109           *
    110           * @brief   Process all the DEBUG commands that are issued by test tool
    111           *
    112           * @param   pBuf  - pointer to received SPI data message
    113           *
    114           * @return  status
    115           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    116          uint8 MT_UtilCommandProcessing(uint8 *pBuf)
   \                     MT_UtilCommandProcessing:
    117          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 13
   \   000005   74F3         MOV     A,#-0xd
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    118            uint8 status = MT_RPC_SUCCESS;
   \   00000A   75..00       MOV     ?V0 + 2,#0x0
    119          
    120            switch (pBuf[MT_RPC_POS_CMD1])
   \   00000D   8A82         MOV     DPL,R2
   \   00000F   8B83         MOV     DPH,R3
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F8           MOV     R0,A
   \   000015   EA           MOV     A,R2
   \   000016   2403         ADD     A,#0x3
   \   000018   F582         MOV     DPL,A
   \   00001A   EB           MOV     A,R3
   \   00001B   3400         ADDC    A,#0x0
   \   00001D   F583         MOV     DPH,A
   \   00001F   E8           MOV     A,R0
   \   000020   604D         JZ      ??MT_UtilCommandProcessing_0
   \   000022   14           DEC     A
   \   000023   6050         JZ      ??MT_UtilCommandProcessing_1
   \   000025   14           DEC     A
   \   000026   6053         JZ      ??MT_UtilCommandProcessing_2
   \   000028   14           DEC     A
   \   000029   6056         JZ      ??MT_UtilCommandProcessing_3
   \   00002B   14           DEC     A
   \   00002C   6059         JZ      ??MT_UtilCommandProcessing_4
   \   00002E   14           DEC     A
   \   00002F   605C         JZ      ??MT_UtilCommandProcessing_5
   \   000031   14           DEC     A
   \   000032   605F         JZ      ??MT_UtilCommandProcessing_6
   \   000034   14           DEC     A
   \   000035   7003         JNZ     $+5
   \   000037   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
   \   00003A   24FE         ADD     A,#-0x2
   \   00003C   6061         JZ      ??MT_UtilCommandProcessing_8
   \   00003E   14           DEC     A
   \   00003F   6058         JZ      ??MT_UtilCommandProcessing_9
   \   000041   24CA         ADD     A,#-0x36
   \   000043   6060         JZ      ??MT_UtilCommandProcessing_10
   \   000045   14           DEC     A
   \   000046   7003         JNZ     $+5
   \   000048   02....       LJMP    ??MT_UtilCommandProcessing_11 & 0xFFFF
   \   00004B   24FD         ADD     A,#-0x3
   \   00004D   7003         JNZ     $+5
   \   00004F   02....       LJMP    ??MT_UtilCommandProcessing_12 & 0xFFFF
   \   000052   24FC         ADD     A,#-0x4
   \   000054   7003         JNZ     $+5
   \   000056   02....       LJMP    ??MT_UtilCommandProcessing_13 & 0xFFFF
   \   000059   14           DEC     A
   \   00005A   7003         JNZ     $+5
   \   00005C   02....       LJMP    ??MT_UtilCommandProcessing_14 & 0xFFFF
   \   00005F   14           DEC     A
   \   000060   7003         JNZ     $+5
   \   000062   02....       LJMP    ??MT_UtilCommandProcessing_15 & 0xFFFF
   \   000065   246A         ADD     A,#0x6a
   \   000067   7003         JNZ     $+5
   \   000069   02....       LJMP    ??MT_UtilCommandProcessing_16 & 0xFFFF
   \   00006C   02....       LJMP    ??MT_UtilCommandProcessing_17 & 0xFFFF
    121            {
    122              case MT_UTIL_GET_DEVICE_INFO:
    123                MT_UtilGetDeviceInfo();
   \                     ??MT_UtilCommandProcessing_0:
   \   00006F                ; Setup parameters for call to function MT_UtilGetDeviceInfo
   \   00006F   12....       LCALL   ??MT_UtilGetDeviceInfo?relay
    124                break;
   \   000072   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    125          
    126              case MT_UTIL_GET_NV_INFO:
    127                MT_UtilGetNvInfo();
   \                     ??MT_UtilCommandProcessing_1:
   \   000075                ; Setup parameters for call to function MT_UtilGetNvInfo
   \   000075   12....       LCALL   ??MT_UtilGetNvInfo?relay
    128                break;
   \   000078   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    129          
    130              case MT_UTIL_SET_PANID:
    131                MT_UtilSetPanID(pBuf);
   \                     ??MT_UtilCommandProcessing_2:
   \   00007B                ; Setup parameters for call to function MT_UtilSetPanID
   \   00007B   12....       LCALL   ??MT_UtilSetPanID?relay
    132                break;
   \   00007E   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    133          
    134              case MT_UTIL_SET_CHANNELS:
    135                MT_UtilSetChannels(pBuf);
   \                     ??MT_UtilCommandProcessing_3:
   \   000081                ; Setup parameters for call to function MT_UtilSetChannels
   \   000081   12....       LCALL   ??MT_UtilSetChannels?relay
    136                break;
   \   000084   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    137          
    138              case MT_UTIL_SET_SECLEVEL:
    139                MT_UtilSetSecLevel(pBuf);
   \                     ??MT_UtilCommandProcessing_4:
   \   000087                ; Setup parameters for call to function MT_UtilSetSecLevel
   \   000087   12....       LCALL   ??MT_UtilSetSecLevel?relay
    140                break;
   \   00008A   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    141          
    142              case MT_UTIL_SET_PRECFGKEY:
    143                MT_UtilSetPreCfgKey(pBuf);
   \                     ??MT_UtilCommandProcessing_5:
   \   00008D                ; Setup parameters for call to function MT_UtilSetPreCfgKey
   \   00008D   12....       LCALL   ??MT_UtilSetPreCfgKey?relay
    144                break;
   \   000090   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    145          
    146              case MT_UTIL_CALLBACK_SUB_CMD:
    147                MT_UtilCallbackSub(pBuf);
   \                     ??MT_UtilCommandProcessing_6:
   \   000093                ; Setup parameters for call to function MT_UtilCallbackSub
   \   000093   12....       LCALL   ??MT_UtilCallbackSub?relay
    148                break;
   \   000096   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    149          
    150              case MT_UTIL_KEY_EVENT:
    151          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    152                MT_UtilKeyEvent(pBuf);
    153          #endif
    154                break;
    155          
    156              case MT_UTIL_LED_CONTROL:
    157          #if (defined HAL_LED) && (HAL_LED == TRUE)
    158                MT_UtilLedControl(pBuf);
   \                     ??MT_UtilCommandProcessing_9:
   \   000099                ; Setup parameters for call to function MT_UtilLedControl
   \   000099   12....       LCALL   ??MT_UtilLedControl?relay
    159          #endif
    160                break;
   \   00009C   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    161          
    162              case MT_UTIL_TIME_ALIVE:
    163                MT_UtilTimeAlive();
   \                     ??MT_UtilCommandProcessing_8:
   \   00009F                ; Setup parameters for call to function MT_UtilTimeAlive
   \   00009F   12....       LCALL   ??MT_UtilTimeAlive?relay
    164                break;
   \   0000A2   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    165          
    166              case MT_UTIL_ADDRMGR_EXT_ADDR_LOOKUP:
    167                MT_UtilAddrMgrExtAddrLookup(pBuf);
   \                     ??MT_UtilCommandProcessing_10:
   \   0000A5   88..         MOV     ?V0 + 5,R0
   \   0000A7   AE82         MOV     R6,DPL
   \   0000A9   AF83         MOV     R7,DPH
   \   0000AB                ; Setup parameters for call to function AddrMgrExtAddrLookup
   \   0000AB   EE           MOV     A,R6
   \   0000AC   FC           MOV     R4,A
   \   0000AD   EF           MOV     A,R7
   \   0000AE   FD           MOV     R5,A
   \   0000AF   A3           INC     DPTR
   \   0000B0   A3           INC     DPTR
   \   0000B1   A3           INC     DPTR
   \   0000B2   A3           INC     DPTR
   \   0000B3   A3           INC     DPTR
   \   0000B4   A3           INC     DPTR
   \   0000B5   A3           INC     DPTR
   \   0000B6   A3           INC     DPTR
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   FA           MOV     R2,A
   \   0000B9   8E82         MOV     DPL,R6
   \   0000BB   8F83         MOV     DPH,R7
   \   0000BD   A3           INC     DPTR
   \   0000BE   A3           INC     DPTR
   \   0000BF   A3           INC     DPTR
   \   0000C0   A3           INC     DPTR
   \   0000C1   A3           INC     DPTR
   \   0000C2   A3           INC     DPTR
   \   0000C3   A3           INC     DPTR
   \   0000C4   A3           INC     DPTR
   \   0000C5   A3           INC     DPTR
   \   0000C6   E0           MOVX    A,@DPTR
   \   0000C7   F9           MOV     R1,A
   \   0000C8   EA           MOV     A,R2
   \   0000C9   2400         ADD     A,#0x0
   \   0000CB   E4           CLR     A
   \   0000CC   39           ADDC    A,R1
   \   0000CD   FB           MOV     R3,A
   \   0000CE   12....       LCALL   ??AddrMgrExtAddrLookup?relay
   \   0000D1                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000D1   EE           MOV     A,R6
   \   0000D2   FC           MOV     R4,A
   \   0000D3   EF           MOV     A,R7
   \   0000D4   FD           MOV     R5,A
   \   0000D5   7B08         MOV     R3,#0x8
   \   0000D7   AA..         MOV     R2,?V0 + 5
   \                     ??MT_UtilCommandProcessing_18:
   \   0000D9   7963         MOV     R1,#0x63
   \                     ??MT_UtilCommandProcessing_19:
   \   0000DB   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    168                break;
   \   0000DE   8079         SJMP    ??MT_UtilCommandProcessing_7
    169          
    170              case MT_UTIL_ADDRMGR_NWK_ADDR_LOOKUP:
    171                MT_UtilAddrMgrEntryLookupNwk(pBuf);
   \                     ??MT_UtilCommandProcessing_11:
   \   0000E0   88..         MOV     ?V0 + 3,R0
   \   0000E2   E0           MOVX    A,@DPTR
   \   0000E3   FA           MOV     R2,A
   \   0000E4   A3           INC     DPTR
   \   0000E5   E0           MOVX    A,@DPTR
   \   0000E6   F9           MOV     R1,A
   \   0000E7   EA           MOV     A,R2
   \   0000E8   F8           MOV     R0,A
   \   0000E9   7401         MOV     A,#0x1
   \   0000EB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EE   E8           MOV     A,R0
   \   0000EF   F0           MOVX    @DPTR,A
   \   0000F0   A3           INC     DPTR
   \   0000F1   E9           MOV     A,R1
   \   0000F2   12....       LCALL   ?Subroutine15 & 0xFFFF
   \                     ??CrossCallReturnLabel_27:
   \   0000F5   AA82         MOV     R2,DPL
   \   0000F7   AB83         MOV     R3,DPH
   \   0000F9   12....       LCALL   ??AddrMgrEntryLookupNwk?relay
   \   0000FC                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000FC   7403         MOV     A,#0x3
   \   0000FE   12....       LCALL   ?XSTACK_DISP0_8
   \   000101   AC82         MOV     R4,DPL
   \   000103   AD83         MOV     R5,DPH
   \   000105   7B08         MOV     R3,#0x8
   \   000107   AA..         MOV     R2,?V0 + 3
   \   000109   80CE         SJMP    ??MT_UtilCommandProcessing_18
    172                break;
    173          
    174              case MT_UTIL_APSME_LINK_KEY_DATA_GET:
    175                MT_UtilAPSME_LinkKeyDataGet(pBuf);
   \                     ??MT_UtilCommandProcessing_12:
   \   00010B                ; Setup parameters for call to function MT_UtilAPSME_LinkKeyDataGet
   \   00010B   12....       LCALL   ??MT_UtilAPSME_LinkKeyDataGet?relay
    176                break;
   \   00010E   8049         SJMP    ??MT_UtilCommandProcessing_7
    177          
    178              case MT_UTIL_ASSOC_COUNT:
    179                MT_UtilAssocCount(pBuf);
   \                     ??MT_UtilCommandProcessing_13:
   \   000110   88..         MOV     ?V0 + 4,R0
   \   000112   AE82         MOV     R6,DPL
   \   000114   AF83         MOV     R7,DPH
   \   000116   A3           INC     DPTR
   \   000117   8582..       MOV     ?V0 + 0,DPL
   \   00011A   8583..       MOV     ?V0 + 1,DPH
   \   00011D                ; Setup parameters for call to function AssocCount
   \   00011D   E0           MOVX    A,@DPTR
   \   00011E   FA           MOV     R2,A
   \   00011F   8E82         MOV     DPL,R6
   \   000121   8F83         MOV     DPH,R7
   \   000123   E0           MOVX    A,@DPTR
   \   000124   F9           MOV     R1,A
   \   000125   12....       LCALL   ??AssocCount?relay
   \   000128   EA           MOV     A,R2
   \   000129   8E82         MOV     DPL,R6
   \   00012B   8F83         MOV     DPH,R7
   \   00012D   F0           MOVX    @DPTR,A
   \   00012E   85..82       MOV     DPL,?V0 + 0
   \   000131   85..83       MOV     DPH,?V0 + 1
   \   000134   EB           MOV     A,R3
   \   000135   F0           MOVX    @DPTR,A
   \   000136                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000136   EE           MOV     A,R6
   \   000137   FC           MOV     R4,A
   \   000138   EF           MOV     A,R7
   \   000139   FD           MOV     R5,A
   \   00013A   7B02         MOV     R3,#0x2
   \   00013C   AA..         MOV     R2,?V0 + 4
   \   00013E   8099         SJMP    ??MT_UtilCommandProcessing_18
    180                break;
    181          
    182              case MT_UTIL_ASSOC_FIND_DEVICE:
    183                MT_UtilAssocFindDevice(pBuf);
   \                     ??MT_UtilCommandProcessing_14:
   \   000140                ; Setup parameters for call to function MT_UtilAssocFindDevice
   \   000140   12....       LCALL   ??MT_UtilAssocFindDevice?relay
    184                break;
   \   000143   8014         SJMP    ??MT_UtilCommandProcessing_7
    185          
    186              case MT_UTIL_ASSOC_GET_WITH_ADDRESS:
    187                MT_UtilAssocGetWithAddress(pBuf);
   \                     ??MT_UtilCommandProcessing_15:
   \   000145                ; Setup parameters for call to function MT_UtilAssocGetWithAddress
   \   000145   12....       LCALL   ??MT_UtilAssocGetWithAddress?relay
    188                break;
   \   000148   800F         SJMP    ??MT_UtilCommandProcessing_7
    189          
    190          #if defined ZCL_KEY_ESTABLISH
    191              case MT_UTIL_ZCL_KEY_EST_INIT_EST:
    192                MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(pBuf);
    193                break;
    194          
    195              case MT_UTIL_ZCL_KEY_EST_SIGN:
    196                MT_UtilzclGeneral_KeyEstablishment_ECDSASign(pBuf);
    197                break;
    198          #endif
    199          
    200              case MT_UTIL_SYNC_REQ:
    201                MT_UtilSync();
   \                     ??MT_UtilCommandProcessing_16:
   \   00014A                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00014A   7C00         MOV     R4,#0x0
   \   00014C   7D00         MOV     R5,#0x0
   \   00014E   7B00         MOV     R3,#0x0
   \   000150   7AE0         MOV     R2,#-0x20
   \   000152   7947         MOV     R1,#0x47
   \   000154   8085         SJMP    ??MT_UtilCommandProcessing_19
    202                break;
    203          
    204              default:
    205                status = MT_RPC_ERR_COMMAND_ID;
   \                     ??MT_UtilCommandProcessing_17:
   \   000156   75..02       MOV     ?V0 + 2,#0x2
    206                break;
    207            }
    208          
    209            return status;
   \                     ??MT_UtilCommandProcessing_7:
   \   000159   A9..         MOV     R1,?V0 + 2
   \   00015B   740D         MOV     A,#0xd
   \   00015D   02....       LJMP    ?Subroutine0 & 0xFFFF
    210          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F08         MOV     R7,#0x8
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA
    211          
    212          /***************************************************************************************************
    213           * @fn      MT_UtilGetDeviceInfo
    214           *
    215           * @brief   The Get Device Info serial message.
    216           *
    217           * @param   void
    218           *
    219           * @return  void
    220           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    221          void MT_UtilGetDeviceInfo(void)
   \                     MT_UtilGetDeviceInfo:
    222          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    223            uint8  *buf;
    224            uint8  *pBuf;
    225            uint8  bufLen = MT_UTIL_DEVICE_INFO_RESPONSE_LEN;
   \   00000A   75..0E       MOV     ?V0 + 2,#0xe
    226          #if !defined NONWK
    227            uint8  assocCnt = 0;
   \   00000D   85..82       MOV     DPL,?XSP + 0
   \   000010   85..83       MOV     DPH,?XSP + 1
   \   000013   E4           CLR     A
   \   000014   F0           MOVX    @DPTR,A
    228            uint16 *assocList = NULL;
   \   000015   FE           MOV     R6,A
   \   000016   FF           MOV     R7,A
    229          
    230            if (ZG_DEVICE_RTR_TYPE)
   \   000017   90....       MOV     DPTR,#zgDeviceLogicalType
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   6004         JZ      ??MT_UtilGetDeviceInfo_0
   \   00001D   6401         XRL     A,#0x1
   \   00001F   7022         JNZ     ??MT_UtilGetDeviceInfo_1
    231            {
    232              assocList = AssocMakeList( &assocCnt );
   \                     ??MT_UtilGetDeviceInfo_0:
   \   000021                ; Setup parameters for call to function AssocMakeList
   \   000021   85..82       MOV     DPL,?XSP + 0
   \   000024   85..83       MOV     DPH,?XSP + 1
   \   000027   AA82         MOV     R2,DPL
   \   000029   AB83         MOV     R3,DPH
   \   00002B   12....       LCALL   ??AssocMakeList?relay
   \   00002E   8A..         MOV     ?V0 + 0,R2
   \   000030   8B..         MOV     ?V0 + 1,R3
   \   000032   AE..         MOV     R6,?V0 + 0
   \   000034   AF..         MOV     R7,?V0 + 1
    233              bufLen += (assocCnt * sizeof(uint16));
   \   000036   85..82       MOV     DPL,?XSP + 0
   \   000039   85..83       MOV     DPH,?XSP + 1
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   C3           CLR     C
   \   00003E   33           RLC     A
   \   00003F   240E         ADD     A,#0xe
   \   000041   F5..         MOV     ?V0 + 2,A
    234            }
    235          #endif
    236          
    237            buf = osal_mem_alloc( bufLen );
   \                     ??MT_UtilGetDeviceInfo_1:
   \   000043                ; Setup parameters for call to function osal_mem_alloc
   \   000043   85....       MOV     ?V0 + 0,?V0 + 2
   \   000046   AA..         MOV     R2,?V0 + 0
   \   000048   7B00         MOV     R3,#0x0
   \   00004A   12....       LCALL   ??osal_mem_alloc?relay
   \   00004D   8A..         MOV     ?V0 + 0,R2
   \   00004F   8B..         MOV     ?V0 + 1,R3
    238            if ( buf )
   \   000051   EA           MOV     A,R2
   \   000052   45..         ORL     A,?V0 + 1
   \   000054   7003         JNZ     $+5
   \   000056   02....       LJMP    ??MT_UtilGetDeviceInfo_2 & 0xFFFF
    239            {
    240              pBuf = buf;
    241          
    242              *pBuf++ = ZSUCCESS; // Status
   \   000059   8A82         MOV     DPL,R2
   \   00005B   8B83         MOV     DPH,R3
   \   00005D   E4           CLR     A
   \   00005E   12....       LCALL   ?Subroutine16 & 0xFFFF
    243          
    244              osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
   \                     ??CrossCallReturnLabel_30:
   \   000061                ; Setup parameters for call to function osal_nv_read
   \   000061   78..         MOV     R0,#?V0 + 6
   \   000063   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000066   75..08       MOV     ?V0 + 4,#0x8
   \   000069   75..00       MOV     ?V0 + 5,#0x0
   \   00006C   78..         MOV     R0,#?V0 + 4
   \   00006E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000071   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_38:
   \   000074   12....       LCALL   ?DEALLOC_XSTACK8
    245              pBuf += Z_EXTADDR_LEN;
   \   000077   E5..         MOV     A,?V0 + 6
   \   000079   2408         ADD     A,#0x8
   \   00007B   F5..         MOV     ?V0 + 6,A
   \   00007D   E5..         MOV     A,?V0 + 7
   \   00007F   3400         ADDC    A,#0x0
   \   000081   F5..         MOV     ?V0 + 7,A
    246          
    247          #if defined NONWK
    248              // Skip past ZStack only parameters for NONWK
    249              *pBuf++ = 0;
    250              *pBuf++ = 0;
    251              *pBuf++ = 0;
    252              *pBuf++ = 0;
    253              *pBuf = 0;
    254          #else
    255              {
    256                uint16 shortAddr = NLME_GetShortAddr();
   \   000083                ; Setup parameters for call to function NLME_GetShortAddr
   \   000083   12....       LCALL   ??NLME_GetShortAddr?relay
    257                *pBuf++ = LO_UINT16( shortAddr );
   \   000086   EA           MOV     A,R2
   \   000087   85..82       MOV     DPL,?V0 + 6
   \   00008A   85..83       MOV     DPH,?V0 + 7
   \   00008D   F0           MOVX    @DPTR,A
   \   00008E   A3           INC     DPTR
    258                *pBuf++ = HI_UINT16( shortAddr );
   \   00008F   EB           MOV     A,R3
   \   000090   F0           MOVX    @DPTR,A
   \   000091   A3           INC     DPTR
    259              }
    260          
    261              /* Return device type */
    262              *pBuf++ = ZSTACK_DEVICE_BUILD;
   \   000092   7404         MOV     A,#0x4
   \   000094   12....       LCALL   ?Subroutine16 & 0xFFFF
    263          
    264              /*Return device state */
    265              *pBuf++ = (uint8)devState;
   \                     ??CrossCallReturnLabel_31:
   \   000097   90....       MOV     DPTR,#devState
   \   00009A   12....       LCALL   ?Subroutine5 & 0xFFFF
    266          
    267              if (ZG_DEVICE_RTR_TYPE)
   \                     ??CrossCallReturnLabel_3:
   \   00009D   A3           INC     DPTR
   \   00009E   8582..       MOV     ?V0 + 4,DPL
   \   0000A1   8583..       MOV     ?V0 + 5,DPH
   \   0000A4   90....       MOV     DPTR,#zgDeviceLogicalType
   \   0000A7   E0           MOVX    A,@DPTR
   \   0000A8   6004         JZ      ??MT_UtilGetDeviceInfo_3
   \   0000AA   6401         XRL     A,#0x1
   \   0000AC   7046         JNZ     ??MT_UtilGetDeviceInfo_4
    268              {
    269                *pBuf++ = assocCnt;
   \                     ??MT_UtilGetDeviceInfo_3:
   \   0000AE   85..82       MOV     DPL,?XSP + 0
   \   0000B1   85..83       MOV     DPH,?XSP + 1
   \   0000B4   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_34:
   \   0000B7   85....       MOV     ?V0 + 6,?V0 + 4
   \   0000BA   85....       MOV     ?V0 + 7,?V0 + 5
    270          
    271                if ( assocCnt )
   \   0000BD   85..82       MOV     DPL,?XSP + 0
   \   0000C0   85..83       MOV     DPH,?XSP + 1
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   6036         JZ      ??MT_UtilGetDeviceInfo_5
    272                {
    273                  uint8 x;
    274                  uint16 *puint16 = assocList;
   \   0000C6   EE           MOV     A,R6
   \   0000C7   F8           MOV     R0,A
   \   0000C8   EF           MOV     A,R7
   \   0000C9   F9           MOV     R1,A
    275          
    276                  for ( x = 0; x < assocCnt; x++, puint16++ )
   \   0000CA   7C00         MOV     R4,#0x0
   \                     ??MT_UtilGetDeviceInfo_6:
   \   0000CC   85..82       MOV     DPL,?XSP + 0
   \   0000CF   85..83       MOV     DPH,?XSP + 1
   \   0000D2   E0           MOVX    A,@DPTR
   \   0000D3   FA           MOV     R2,A
   \   0000D4   EC           MOV     A,R4
   \   0000D5   C3           CLR     C
   \   0000D6   9A           SUBB    A,R2
   \   0000D7   5023         JNC     ??MT_UtilGetDeviceInfo_5
    277                  {
    278                    *pBuf++ = LO_UINT16( *puint16 );
   \   0000D9   8882         MOV     DPL,R0
   \   0000DB   8983         MOV     DPH,R1
   \   0000DD   12....       LCALL   ?Subroutine5 & 0xFFFF
    279                    *pBuf++ = HI_UINT16( *puint16 );
   \                     ??CrossCallReturnLabel_4:
   \   0000E0   8882         MOV     DPL,R0
   \   0000E2   8983         MOV     DPH,R1
   \   0000E4   A3           INC     DPTR
   \   0000E5   12....       LCALL   ?Subroutine5 & 0xFFFF
    280                  }
   \                     ??CrossCallReturnLabel_5:
   \   0000E8   0C           INC     R4
   \   0000E9   E8           MOV     A,R0
   \   0000EA   2402         ADD     A,#0x2
   \   0000EC   08           INC     R0
   \   0000ED   08           INC     R0
   \   0000EE   E9           MOV     A,R1
   \   0000EF   3400         ADDC    A,#0x0
   \   0000F1   F9           MOV     R1,A
   \   0000F2   80D8         SJMP    ??MT_UtilGetDeviceInfo_6
    281                }
    282              }
    283              else
    284              {
    285                *pBuf++ = 0;
   \                     ??MT_UtilGetDeviceInfo_4:
   \   0000F4   85..82       MOV     DPL,?V0 + 6
   \   0000F7   85..83       MOV     DPH,?V0 + 7
   \   0000FA   E4           CLR     A
   \   0000FB   F0           MOVX    @DPTR,A
    286              }
    287          #endif
    288          
    289              MT_BuildAndSendZToolResponse( ((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
    290                                           MT_UTIL_GET_DEVICE_INFO,
    291                                           bufLen, buf );
   \                     ??MT_UtilGetDeviceInfo_5:
   \   0000FC                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000FC   AC..         MOV     R4,?V0 + 0
   \   0000FE   AD..         MOV     R5,?V0 + 1
   \   000100   AB..         MOV     R3,?V0 + 2
   \   000102   7A00         MOV     R2,#0x0
   \   000104   7967         MOV     R1,#0x67
   \   000106   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    292          
    293              osal_mem_free( buf );
   \   000109                ; Setup parameters for call to function osal_mem_free
   \   000109   AA..         MOV     R2,?V0 + 0
   \   00010B   AB..         MOV     R3,?V0 + 1
   \   00010D   12....       LCALL   ??osal_mem_free?relay
    294            }
    295          
    296            if ( assocList )
   \                     ??MT_UtilGetDeviceInfo_2:
   \   000110   EE           MOV     A,R6
   \   000111   4F           ORL     A,R7
   \   000112   6007         JZ      ??MT_UtilGetDeviceInfo_7
    297            {
    298              osal_mem_free( assocList );
   \   000114                ; Setup parameters for call to function osal_mem_free
   \   000114   EE           MOV     A,R6
   \   000115   FA           MOV     R2,A
   \   000116   EF           MOV     A,R7
   \   000117   FB           MOV     R3,A
   \   000118   12....       LCALL   ??osal_mem_free?relay
    299            }
    300          }
   \                     ??MT_UtilGetDeviceInfo_7:
   \   00011B   7401         MOV     A,#0x1
   \   00011D   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   8582..       MOV     ?V0 + 6,DPL
   \   000005   8583..       MOV     ?V0 + 7,DPH
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   7C00         MOV     R4,#0x0
   \   000002   7D00         MOV     R5,#0x0
   \   000004   7A01         MOV     R2,#0x1
   \   000006                REQUIRE ??Subroutine20_0
   \   000006                ; // Fall through to label ??Subroutine20_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine20_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_read?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_35:
   \   000003   A3           INC     DPTR
   \   000004   8582..       MOV     ?V0 + 6,DPL
   \   000007   8583..       MOV     ?V0 + 7,DPH
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   85..82       MOV     DPL,?V0 + 6
   \   000004   85..83       MOV     DPH,?V0 + 7
   \   000007   F0           MOVX    @DPTR,A
   \   000008   22           RET
    301          
    302          /***************************************************************************************************
    303           * @fn      MT_UtilGetNvInfo
    304           *
    305           * @brief   The Get NV Info serial message.
    306           *
    307           * @param   byte *msg - pointer to the data
    308           *
    309           * @return  void
    310           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    311          void MT_UtilGetNvInfo(void)
   \                     MT_UtilGetNvInfo:
    312          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 6
   \   000005   74FA         MOV     A,#-0x6
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    313            uint8 len;
    314            uint8 stat;
    315            uint8 *buf;
    316            uint8 *pBuf;
    317            uint16 tmp16;
    318            uint32 tmp32;
    319          
    320            /*
    321              Get required length of buffer
    322              Status + ExtAddr + ChanList + PanID  + SecLevel + PreCfgKey
    323            */
    324            len = 1 + Z_EXTADDR_LEN + 4 + 2 + 1 + SEC_KEY_LEN;
    325          
    326            buf = osal_mem_alloc( len );
   \   00000A                ; Setup parameters for call to function osal_mem_alloc
   \   00000A   7A20         MOV     R2,#0x20
   \   00000C   7B00         MOV     R3,#0x0
   \   00000E   12....       LCALL   ??osal_mem_alloc?relay
   \   000011   8A..         MOV     ?V0 + 0,R2
   \   000013   8B..         MOV     ?V0 + 1,R3
   \   000015   AE..         MOV     R6,?V0 + 0
   \   000017   AF..         MOV     R7,?V0 + 1
    327            if ( buf )
   \   000019   EE           MOV     A,R6
   \   00001A   4F           ORL     A,R7
   \   00001B   7003         JNZ     $+5
   \   00001D   02....       LJMP    ??MT_UtilGetNvInfo_0 & 0xFFFF
    328            {
    329              /* Assume NV not available */
    330              osal_memset( buf, 0xFF, len );
   \   000020                ; Setup parameters for call to function osal_memset
   \   000020   7C20         MOV     R4,#0x20
   \   000022   7D00         MOV     R5,#0x0
   \   000024   79FF         MOV     R1,#-0x1
   \   000026   12....       LCALL   ??osal_memset?relay
    331          
    332              /* Skip over status */
    333              pBuf = buf + 1;
   \   000029   8E82         MOV     DPL,R6
   \   00002B   8F83         MOV     DPH,R7
   \   00002D   A3           INC     DPTR
   \   00002E   8582..       MOV     ?V0 + 2,DPL
   \   000031   8583..       MOV     ?V0 + 3,DPH
    334          
    335              /* Start with 64-bit extended address */
    336              stat = osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
   \   000034                ; Setup parameters for call to function osal_nv_read
   \   000034   78..         MOV     R0,#?V0 + 2
   \   000036   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000039   75..08       MOV     ?V0 + 0,#0x8
   \   00003C   75..00       MOV     ?V0 + 1,#0x0
   \   00003F   78..         MOV     R0,#?V0 + 0
   \   000041   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000044   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_39:
   \   000047   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004A   E9           MOV     A,R1
   \   00004B   F5..         MOV     ?V0 + 0,A
    337              if ( stat ) stat = 0x01;
   \   00004D   6003         JZ      ??MT_UtilGetNvInfo_1
   \   00004F   75..01       MOV     ?V0 + 0,#0x1
    338              pBuf += Z_EXTADDR_LEN;
   \                     ??MT_UtilGetNvInfo_1:
   \   000052   E5..         MOV     A,?V0 + 2
   \   000054   2408         ADD     A,#0x8
   \   000056   F5..         MOV     ?V0 + 2,A
   \   000058   E5..         MOV     A,?V0 + 3
   \   00005A   3400         ADDC    A,#0x0
   \   00005C   F5..         MOV     ?V0 + 3,A
    339          
    340              /* Scan channel list (bit mask) */
    341              if (  osal_nv_read( ZCD_NV_CHANLIST, 0, sizeof( tmp32 ), &tmp32 ) )
   \   00005E                ; Setup parameters for call to function osal_nv_read
   \   00005E   7402         MOV     A,#0x2
   \   000060   12....       LCALL   ?XSTACK_DISP0_8
   \   000063   8582..       MOV     ?V0 + 4,DPL
   \   000066   8583..       MOV     ?V0 + 5,DPH
   \   000069   78..         MOV     R0,#?V0 + 4
   \   00006B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006E   75..04       MOV     ?V0 + 4,#0x4
   \   000071   75..00       MOV     ?V0 + 5,#0x0
   \   000074   78..         MOV     R0,#?V0 + 4
   \   000076   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000079   7C00         MOV     R4,#0x0
   \   00007B   7D00         MOV     R5,#0x0
   \   00007D   7A84         MOV     R2,#-0x7c
   \   00007F   12....       LCALL   ??Subroutine20_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_40:
   \   000082   12....       LCALL   ?DEALLOC_XSTACK8
   \   000085   E9           MOV     A,R1
   \   000086   6008         JZ      ??MT_UtilGetNvInfo_2
    342                stat |= 0x02;
   \   000088   E5..         MOV     A,?V0 + 0
   \   00008A   D2E1         SETB    0xE0 /* A   */.1
   \   00008C   F5..         MOV     ?V0 + 0,A
   \   00008E   8060         SJMP    ??MT_UtilGetNvInfo_3
    343              else
    344              {
    345                pBuf[0] = BREAK_UINT32( tmp32, 3 );
   \                     ??MT_UtilGetNvInfo_2:
   \   000090   7402         MOV     A,#0x2
   \   000092   12....       LCALL   ?XSTACK_DISP0_8
   \   000095   78..         MOV     R0,#?V0 + 4
   \   000097   12....       LCALL   ?L_MOV_X
   \   00009A   7418         MOV     A,#0x18
   \   00009C   78..         MOV     R0,#?V0 + 4
   \   00009E   12....       LCALL   ?UL_SHR
   \   0000A1   85..82       MOV     DPL,?V0 + 2
   \   0000A4   85..83       MOV     DPH,?V0 + 3
   \   0000A7   E5..         MOV     A,?V0 + 4
   \   0000A9   F0           MOVX    @DPTR,A
    346                pBuf[1] = BREAK_UINT32( tmp32, 2 );
   \   0000AA   7402         MOV     A,#0x2
   \   0000AC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AF   78..         MOV     R0,#?V0 + 4
   \   0000B1   12....       LCALL   ?L_MOV_X
   \   0000B4   7410         MOV     A,#0x10
   \   0000B6   78..         MOV     R0,#?V0 + 4
   \   0000B8   12....       LCALL   ?UL_SHR
   \   0000BB   85..82       MOV     DPL,?V0 + 2
   \   0000BE   85..83       MOV     DPH,?V0 + 3
   \   0000C1   A3           INC     DPTR
   \   0000C2   E5..         MOV     A,?V0 + 4
   \   0000C4   F0           MOVX    @DPTR,A
    347                pBuf[2] = BREAK_UINT32( tmp32, 1 );
   \   0000C5   7402         MOV     A,#0x2
   \   0000C7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000CA   78..         MOV     R0,#?V0 + 4
   \   0000CC   12....       LCALL   ?L_MOV_X
   \   0000CF   E5..         MOV     A,?V0 + 5
   \   0000D1   85..82       MOV     DPL,?V0 + 2
   \   0000D4   85..83       MOV     DPH,?V0 + 3
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   F0           MOVX    @DPTR,A
    348                pBuf[3] = BREAK_UINT32( tmp32, 0 );
   \   0000DA   7402         MOV     A,#0x2
   \   0000DC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DF   78..         MOV     R0,#?V0 + 4
   \   0000E1   12....       LCALL   ?L_MOV_X
   \   0000E4   85..82       MOV     DPL,?V0 + 2
   \   0000E7   85..83       MOV     DPH,?V0 + 3
   \   0000EA   A3           INC     DPTR
   \   0000EB   A3           INC     DPTR
   \   0000EC   A3           INC     DPTR
   \   0000ED   E5..         MOV     A,?V0 + 4
   \   0000EF   F0           MOVX    @DPTR,A
    349              }
    350              pBuf += sizeof( tmp32 );
   \                     ??MT_UtilGetNvInfo_3:
   \   0000F0   E5..         MOV     A,?V0 + 2
   \   0000F2   2404         ADD     A,#0x4
   \   0000F4   F5..         MOV     ?V0 + 2,A
   \   0000F6   E5..         MOV     A,?V0 + 3
   \   0000F8   3400         ADDC    A,#0x0
   \   0000FA   F5..         MOV     ?V0 + 3,A
    351          
    352              /* ZigBee PanID */
    353              if ( osal_nv_read( ZCD_NV_PANID, 0, sizeof( tmp16 ), &tmp16 ) )
   \   0000FC                ; Setup parameters for call to function osal_nv_read
   \   0000FC   85..82       MOV     DPL,?XSP + 0
   \   0000FF   85..83       MOV     DPH,?XSP + 1
   \   000102   8582..       MOV     ?V0 + 4,DPL
   \   000105   8583..       MOV     ?V0 + 5,DPH
   \   000108   78..         MOV     R0,#?V0 + 4
   \   00010A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00010D   75..02       MOV     ?V0 + 4,#0x2
   \   000110   75..00       MOV     ?V0 + 5,#0x0
   \   000113   78..         MOV     R0,#?V0 + 4
   \   000115   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000118   7C00         MOV     R4,#0x0
   \   00011A   7D00         MOV     R5,#0x0
   \   00011C   7A83         MOV     R2,#-0x7d
   \   00011E   12....       LCALL   ??Subroutine20_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_41:
   \   000121   12....       LCALL   ?DEALLOC_XSTACK8
   \   000124   E9           MOV     A,R1
   \   000125   6008         JZ      ??MT_UtilGetNvInfo_4
    354                stat |= 0x04;
   \   000127   E5..         MOV     A,?V0 + 0
   \   000129   D2E2         SETB    0xE0 /* A   */.2
   \   00012B   F5..         MOV     ?V0 + 0,A
   \   00012D   801A         SJMP    ??MT_UtilGetNvInfo_5
    355              else
    356              {
    357                pBuf[0] = LO_UINT16( tmp16 );
   \                     ??MT_UtilGetNvInfo_4:
   \   00012F   85..82       MOV     DPL,?XSP + 0
   \   000132   85..83       MOV     DPH,?XSP + 1
   \   000135   E0           MOVX    A,@DPTR
   \   000136   85..82       MOV     DPL,?V0 + 2
   \   000139   85..83       MOV     DPH,?V0 + 3
   \   00013C   12....       LCALL   ?Subroutine15 & 0xFFFF
    358                pBuf[1] = HI_UINT16( tmp16 );
    359              }
   \                     ??CrossCallReturnLabel_28:
   \   00013F   A3           INC     DPTR
   \   000140   E0           MOVX    A,@DPTR
   \   000141   85..82       MOV     DPL,?V0 + 2
   \   000144   85..83       MOV     DPH,?V0 + 3
   \   000147   A3           INC     DPTR
   \   000148   F0           MOVX    @DPTR,A
    360              pBuf += sizeof( tmp16 );
   \                     ??MT_UtilGetNvInfo_5:
   \   000149   E5..         MOV     A,?V0 + 2
   \   00014B   2402         ADD     A,#0x2
   \   00014D   F5..         MOV     ?V0 + 2,A
   \   00014F   E5..         MOV     A,?V0 + 3
   \   000151   3400         ADDC    A,#0x0
   \   000153   F5..         MOV     ?V0 + 3,A
    361          
    362              /* Security level */
    363              if ( osal_nv_read( ZCD_NV_SECURITY_LEVEL, 0, sizeof( uint8 ), pBuf++ ) )
   \   000155                ; Setup parameters for call to function osal_nv_read
   \   000155   78..         MOV     R0,#?V0 + 2
   \   000157   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00015A   75..01       MOV     ?V0 + 4,#0x1
   \   00015D   78..         MOV     R0,#?V0 + 4
   \   00015F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000162   7C00         MOV     R4,#0x0
   \   000164   7D00         MOV     R5,#0x0
   \   000166   7A61         MOV     R2,#0x61
   \   000168   12....       LCALL   ??Subroutine20_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_42:
   \   00016B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00016E   E9           MOV     A,R1
   \   00016F   85..82       MOV     DPL,?V0 + 2
   \   000172   85..83       MOV     DPH,?V0 + 3
   \   000175   A3           INC     DPTR
   \   000176   8582..       MOV     ?V0 + 2,DPL
   \   000179   8583..       MOV     ?V0 + 3,DPH
   \   00017C   6006         JZ      ??MT_UtilGetNvInfo_6
    364                stat |= 0x08;
   \   00017E   E5..         MOV     A,?V0 + 0
   \   000180   D2E3         SETB    0xE0 /* A   */.3
   \   000182   F5..         MOV     ?V0 + 0,A
    365          
    366              /* Pre-configured security key */
    367              if ( osal_nv_read( ZCD_NV_PRECFGKEY, 0, SEC_KEY_LEN, pBuf ) )
   \                     ??MT_UtilGetNvInfo_6:
   \   000184                ; Setup parameters for call to function osal_nv_read
   \   000184   78..         MOV     R0,#?V0 + 2
   \   000186   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000189   75..10       MOV     ?V0 + 2,#0x10
   \   00018C   75..00       MOV     ?V0 + 3,#0x0
   \   00018F   78..         MOV     R0,#?V0 + 2
   \   000191   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000194   7C00         MOV     R4,#0x0
   \   000196   7D00         MOV     R5,#0x0
   \   000198   7A62         MOV     R2,#0x62
   \   00019A   12....       LCALL   ??Subroutine20_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_43:
   \   00019D   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001A0   E9           MOV     A,R1
   \   0001A1   6006         JZ      ??MT_UtilGetNvInfo_7
    368                stat |= 0x10;
   \   0001A3   E5..         MOV     A,?V0 + 0
   \   0001A5   D2E4         SETB    0xE0 /* A   */.4
   \   0001A7   F5..         MOV     ?V0 + 0,A
    369          
    370              /* Status bit mask - bit=1 indicates failure */
    371              *buf = stat;
   \                     ??MT_UtilGetNvInfo_7:
   \   0001A9   8E82         MOV     DPL,R6
   \   0001AB   8F83         MOV     DPH,R7
   \   0001AD   E5..         MOV     A,?V0 + 0
   \   0001AF   F0           MOVX    @DPTR,A
    372          
    373              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), MT_UTIL_GET_NV_INFO,
    374                                            len, buf );
   \   0001B0                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001B0   EE           MOV     A,R6
   \   0001B1   FC           MOV     R4,A
   \   0001B2   EF           MOV     A,R7
   \   0001B3   FD           MOV     R5,A
   \   0001B4   7B20         MOV     R3,#0x20
   \   0001B6   7A01         MOV     R2,#0x1
   \   0001B8   7967         MOV     R1,#0x67
   \   0001BA   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    375          
    376              osal_mem_free( buf );
   \   0001BD                ; Setup parameters for call to function osal_mem_free
   \   0001BD   EE           MOV     A,R6
   \   0001BE   FA           MOV     R2,A
   \   0001BF   EF           MOV     A,R7
   \   0001C0   FB           MOV     R3,A
   \   0001C1   12....       LCALL   ??osal_mem_free?relay
    377            }
    378          }
   \                     ??MT_UtilGetNvInfo_0:
   \   0001C4   7406         MOV     A,#0x6
   \   0001C6                REQUIRE ?Subroutine0
   \   0001C6                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function AddrMgrEntryLookupNwk
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   22           RET
    379          
    380          /***************************************************************************************************
    381           * @fn      MT_UtilSetPanID
    382           *
    383           * @brief   Set PanID message
    384           *
    385           * @param   byte *msg - pointer to the data
    386           *
    387           * @return  void
    388           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    389          void MT_UtilSetPanID(uint8 *pBuf)
   \                     MT_UtilSetPanID:
    390          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    391            uint16 temp16;
    392            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine4 & 0xFFFF
    393            uint8 cmdId;
    394          
    395            /* parse header */
    396            cmdId = pBuf[MT_RPC_POS_CMD1];
    397            pBuf += MT_RPC_FRAME_HDR_SZ;
    398          
    399            temp16 = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_0:
   \   00000D   FC           MOV     R4,A
   \   00000E   A3           INC     DPTR
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F9           MOV     R1,A
   \   000011   EC           MOV     A,R4
   \   000012   F8           MOV     R0,A
   \   000013   7401         MOV     A,#0x1
   \   000015   12....       LCALL   ?XSTACK_DISP0_8
   \   000018   E8           MOV     A,R0
   \   000019   F0           MOVX    @DPTR,A
   \   00001A   A3           INC     DPTR
   \   00001B   E9           MOV     A,R1
   \   00001C   F0           MOVX    @DPTR,A
    400            pBuf += sizeof(uint16);
    401          
    402            retValue = osal_nv_write(ZCD_NV_PANID, 0, osal_nv_item_len( ZCD_NV_PANID ), &temp16);
   \   00001D                ; Setup parameters for call to function osal_nv_write
   \   00001D   7401         MOV     A,#0x1
   \   00001F   12....       LCALL   ?XSTACK_DISP0_8
   \   000022   8582..       MOV     ?V0 + 0,DPL
   \   000025   8583..       MOV     ?V0 + 1,DPH
   \   000028   78..         MOV     R0,#?V0 + 0
   \   00002A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002D                ; Setup parameters for call to function osal_nv_item_len
   \   00002D   7A83         MOV     R2,#-0x7d
   \   00002F   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   000032   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000035   7C00         MOV     R4,#0x0
   \   000037   7D00         MOV     R5,#0x0
   \   000039   7A83         MOV     R2,#-0x7d
   \   00003B   7B00         MOV     R3,#0x0
   \   00003D   12....       LCALL   ??osal_nv_write?relay
   \   000040   7404         MOV     A,#0x4
   \   000042   12....       LCALL   ?DEALLOC_XSTACK8
   \   000045   12....       LCALL   ?Subroutine10 & 0xFFFF
    403          
    404            /* Build and send back the response */
    405            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue);
    406          }
   \                     ??CrossCallReturnLabel_14:
   \   000048   7403         MOV     A,#0x3
   \   00004A   80..         SJMP    ??Subroutine21_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine21_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F02         MOV     R7,#0x2
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   E9           MOV     A,R1
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   F0           MOVX    @DPTR,A
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008   AC82         MOV     R4,DPL
   \   00000A   AD83         MOV     R5,DPH
   \   00000C   7B01         MOV     R3,#0x1
   \   00000E   EE           MOV     A,R6
   \   00000F   FA           MOV     R2,A
   \   000010   7967         MOV     R1,#0x67
   \   000012   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   000015   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_36:
   \   000003   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   000006   8A82         MOV     DPL,R2
   \   000008   8B83         MOV     DPH,R3
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_item_len?relay
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   \   000009   78..         MOV     R0,#?V0 + 0
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   7401         MOV     A,#0x1
   \   000008   F0           MOVX    @DPTR,A
   \   000009   8A82         MOV     DPL,R2
   \   00000B   8B83         MOV     DPH,R3
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   FE           MOV     R6,A
   \   000011   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   EA           MOV     A,R2
   \   000001   2403         ADD     A,#0x3
   \   000003   0A           INC     R2
   \   000004   0A           INC     R2
   \   000005   0A           INC     R2
   \   000006   EB           MOV     A,R3
   \   000007   3400         ADDC    A,#0x0
   \   000009   FB           MOV     R3,A
   \   00000A   22           RET
    407          
    408          /***************************************************************************************************
    409           * @fn      MT_UtilSetChannels
    410           *
    411           * @brief   Set Channels
    412           *
    413           * @param   byte *msg - pointer to the data
    414           *
    415           * @return  void
    416           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    417          void MT_UtilSetChannels(uint8 *pBuf)
   \                     MT_UtilSetChannels:
    418          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    419            uint32 tmp32;
    420            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine4 & 0xFFFF
    421            uint8 cmdId;
    422          
    423            /* parse header */
    424            cmdId = pBuf[MT_RPC_POS_CMD1];
    425            pBuf += MT_RPC_FRAME_HDR_SZ;
    426          
    427            tmp32 = BUILD_UINT32(pBuf[0], pBuf[1], pBuf[2], pBuf[3]);
   \                     ??CrossCallReturnLabel_1:
   \   00000D   F5..         MOV     ?V0 + 0,A
   \   00000F   E4           CLR     A
   \   000010   F5..         MOV     ?V0 + 1,A
   \   000012   F5..         MOV     ?V0 + 2,A
   \   000014   F5..         MOV     ?V0 + 3,A
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   F5..         MOV     ?V0 + 4,A
   \   00001A   E4           CLR     A
   \   00001B   F5..         MOV     ?V0 + 5,A
   \   00001D   F5..         MOV     ?V0 + 6,A
   \   00001F   F5..         MOV     ?V0 + 7,A
   \   000021   7408         MOV     A,#0x8
   \   000023   78..         MOV     R0,#?V0 + 4
   \   000025   12....       LCALL   ?L_SHL
   \   000028   78..         MOV     R0,#?V0 + 0
   \   00002A   79..         MOV     R1,#?V0 + 4
   \   00002C   12....       LCALL   ?L_ADD
   \   00002F   8A82         MOV     DPL,R2
   \   000031   8B83         MOV     DPH,R3
   \   000033   A3           INC     DPTR
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F5..         MOV     ?V0 + 4,A
   \   000038   E4           CLR     A
   \   000039   F5..         MOV     ?V0 + 5,A
   \   00003B   7410         MOV     A,#0x10
   \   00003D   78..         MOV     R0,#?V0 + 4
   \   00003F   12....       LCALL   ?L_SHL
   \   000042   78..         MOV     R0,#?V0 + 0
   \   000044   79..         MOV     R1,#?V0 + 4
   \   000046   12....       LCALL   ?L_ADD
   \   000049   8A82         MOV     DPL,R2
   \   00004B   8B83         MOV     DPH,R3
   \   00004D   A3           INC     DPTR
   \   00004E   A3           INC     DPTR
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   F5..         MOV     ?V0 + 4,A
   \   000053   E4           CLR     A
   \   000054   F5..         MOV     ?V0 + 6,A
   \   000056   7418         MOV     A,#0x18
   \   000058   78..         MOV     R0,#?V0 + 4
   \   00005A   12....       LCALL   ?L_SHL
   \   00005D   78..         MOV     R0,#?V0 + 0
   \   00005F   79..         MOV     R1,#?V0 + 4
   \   000061   12....       LCALL   ?L_ADD
   \   000064   7401         MOV     A,#0x1
   \   000066   12....       LCALL   ?XSTACK_DISP0_8
   \   000069   78..         MOV     R0,#?V0 + 0
   \   00006B   12....       LCALL   ?L_MOV_TO_X
    428          
    429            retValue = osal_nv_write(ZCD_NV_CHANLIST, 0, osal_nv_item_len( ZCD_NV_CHANLIST ), &tmp32);
   \   00006E                ; Setup parameters for call to function osal_nv_write
   \   00006E   7401         MOV     A,#0x1
   \   000070   12....       LCALL   ?XSTACK_DISP0_8
   \   000073   8582..       MOV     ?V0 + 0,DPL
   \   000076   8583..       MOV     ?V0 + 1,DPH
   \   000079   78..         MOV     R0,#?V0 + 0
   \   00007B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00007E                ; Setup parameters for call to function osal_nv_item_len
   \   00007E   7A84         MOV     R2,#-0x7c
   \   000080   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_24:
   \   000083   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000086   7C00         MOV     R4,#0x0
   \   000088   7D00         MOV     R5,#0x0
   \   00008A   7A84         MOV     R2,#-0x7c
   \   00008C   7B00         MOV     R3,#0x0
   \   00008E   12....       LCALL   ??osal_nv_write?relay
   \   000091   7404         MOV     A,#0x4
   \   000093   12....       LCALL   ?DEALLOC_XSTACK8
   \   000096   12....       LCALL   ?Subroutine10 & 0xFFFF
    430          
    431            /* Build and send back the response */
    432            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue);
    433          }
   \                     ??CrossCallReturnLabel_16:
   \   000099   7405         MOV     A,#0x5
   \   00009B   02....       LJMP    ?Subroutine0 & 0xFFFF
    434          
    435          /***************************************************************************************************
    436           * @fn      MT_UtilSetSecLevel
    437           *
    438           * @brief   Set Sec Level
    439           *
    440           * @param   byte *msg - pointer to the data
    441           *
    442           * @return  void
    443           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_write?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   12....       LCALL   ?DEALLOC_XSTACK8
   \   00000A   12....       LCALL   ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   00000D   7401         MOV     A,#0x1
   \   00000F                REQUIRE ??Subroutine21_0
   \   00000F                ; // Fall through to label ??Subroutine21_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    444          void MT_UtilSetSecLevel(uint8 *pBuf)
   \                     MT_UtilSetSecLevel:
    445          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    446            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine6 & 0xFFFF
    447            uint8 cmdId;
    448          
    449            /* parse header */
    450            cmdId = pBuf[MT_RPC_POS_CMD1];
    451            pBuf += MT_RPC_FRAME_HDR_SZ;
    452          
    453            retValue = osal_nv_write( ZCD_NV_SECURITY_LEVEL, 0, osal_nv_item_len( ZCD_NV_SECURITY_LEVEL ), pBuf);
   \                     ??CrossCallReturnLabel_6:
   \   00000D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000010                ; Setup parameters for call to function osal_nv_item_len
   \   000010   7A61         MOV     R2,#0x61
   \   000012   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_25:
   \   000015   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000018   7C00         MOV     R4,#0x0
   \   00001A   7D00         MOV     R5,#0x0
   \   00001C   7A61         MOV     R2,#0x61
   \   00001E   02....       LJMP    ?Subroutine1 & 0xFFFF
    454          
    455            /* Build and send back the response */
    456            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    457          
    458          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_37:
   \   000003                ; Setup parameters for call to function osal_nv_write
   \   000003                ; Setup parameters for call to function osal_nv_write
   \   000003   EA           MOV     A,R2
   \   000004   2403         ADD     A,#0x3
   \   000006   F5..         MOV     ?V0 + 0,A
   \   000008   EB           MOV     A,R3
   \   000009   3400         ADDC    A,#0x0
   \   00000B   F5..         MOV     ?V0 + 1,A
   \   00000D   78..         MOV     R0,#?V0 + 0
   \   00000F   22           RET
    459          
    460          /***************************************************************************************************
    461           * @fn      MT_UtilSetPreCfgKey
    462           *
    463           * @brief   Set Pre Cfg Key
    464           *
    465           * @param   byte *msg - pointer to the data
    466           *
    467           * @return  void
    468           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    469          void MT_UtilSetPreCfgKey(uint8 *pBuf)
   \                     MT_UtilSetPreCfgKey:
    470          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    471            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine6 & 0xFFFF
    472            uint8 cmdId;
    473          
    474            /* parse header */
    475            cmdId = pBuf[MT_RPC_POS_CMD1];
    476            pBuf += MT_RPC_FRAME_HDR_SZ;
    477          
    478            retValue = osal_nv_write( ZCD_NV_PRECFGKEY, 0, osal_nv_item_len( ZCD_NV_PRECFGKEY ), pBuf);
   \                     ??CrossCallReturnLabel_7:
   \   00000D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000010                ; Setup parameters for call to function osal_nv_item_len
   \   000010   7A62         MOV     R2,#0x62
   \   000012   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_26:
   \   000015   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000018   7C00         MOV     R4,#0x0
   \   00001A   7D00         MOV     R5,#0x0
   \   00001C   7A62         MOV     R2,#0x62
   \   00001E   02....       LJMP    ?Subroutine1 & 0xFFFF
    479          
    480            /* Build and send back the response */
    481            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    482          
    483          }
    484          
    485          /***************************************************************************************************
    486           * @fn      MT_UtilCallbackSub
    487           *
    488           * @brief   The Callback subscribe.
    489           *
    490           * @param   byte *msg - pointer to the data
    491           *
    492           * @return  void
    493           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    494          void MT_UtilCallbackSub(uint8 *pBuf)
   \                     MT_UtilCallbackSub:
    495          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    496            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   12....       LCALL   ?Subroutine9 & 0xFFFF
    497            uint8 retValue = ZFailure;
    498          
    499          #if defined(MT_MAC_CB_FUNC) || defined(MT_NWK_CB_FUNC) || defined(MT_ZDO_CB_FUNC) || defined(MT_AF_CB_FUNC) || defined(MT_SAPI_CB_FUNC) || defined(MT_SAPI_CB_FUNC)
    500            uint8 subSystem;
    501            uint16 subscribed_command;
    502          
    503            // Move past header
    504            retValue = ZSuccess;
   \                     ??CrossCallReturnLabel_12:
   \   00000D   E4           CLR     A
   \   00000E   F0           MOVX    @DPTR,A
    505            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00000F   12....       LCALL   ?Subroutine8 & 0xFFFF
    506          
    507            /* Command */
    508            subscribed_command = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_10:
   \   000012   8A82         MOV     DPL,R2
   \   000014   8B83         MOV     DPH,R3
   \   000016   E0           MOVX    A,@DPTR
   \   000017   FC           MOV     R4,A
   \   000018   A3           INC     DPTR
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F9           MOV     R1,A
   \   00001B   EC           MOV     A,R4
   \   00001C   2400         ADD     A,#0x0
   \   00001E   F8           MOV     R0,A
   \   00001F   E4           CLR     A
   \   000020   39           ADDC    A,R1
    509            pBuf += 2;
    510          
    511            /* Subsystem - 5 bits on the MSB of the command */
    512            subSystem = HI_UINT16(subscribed_command) & 0x1F ;
   \   000021   541F         ANL     A,#0x1f
   \   000023   FC           MOV     R4,A
    513          
    514            /* What is the action - SUBSCRIBE or !SUBSCRIBE */
    515            if (*pBuf)
   \   000024   8A82         MOV     DPL,R2
   \   000026   8B83         MOV     DPH,R3
   \   000028   A3           INC     DPTR
   \   000029   A3           INC     DPTR
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   602B         JZ      ??MT_UtilCallbackSub_0
    516            {
    517              /* Turn ON */
    518            #if defined( MT_MAC_CB_FUNC )
    519              if ((subSystem == MT_RPC_SYS_MAC) || (subscribed_command == 0xFFFF))
    520                _macCallbackSub = 0xFFFF;
    521            #endif
    522          
    523            #if defined( MT_NWK_CB_FUNC )
    524              if ((subSystem == MT_RPC_SYS_NWK) || (subscribed_command == 0xFFFF))
   \   00002D   7403         MOV     A,#0x3
   \   00002F   6C           XRL     A,R4
   \   000030   600A         JZ      ??MT_UtilCallbackSub_1
   \   000032   74FF         MOV     A,#-0x1
   \   000034   68           XRL     A,R0
   \   000035   7003         JNZ     ??MT_UtilCallbackSub_2
   \   000037   74FF         MOV     A,#-0x1
   \   000039   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_2:
   \   00003A   7008         JNZ     ??MT_UtilCallbackSub_3
    525                _nwkCallbackSub = 0xFFFF;
   \                     ??MT_UtilCallbackSub_1:
   \   00003C   90....       MOV     DPTR,#_nwkCallbackSub
   \   00003F   74FF         MOV     A,#-0x1
   \   000041   F0           MOVX    @DPTR,A
   \   000042   A3           INC     DPTR
   \   000043   F0           MOVX    @DPTR,A
    526            #endif
    527          
    528            #if defined( MT_ZDO_CB_FUNC )
    529              if ((subSystem == MT_RPC_SYS_ZDO) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_3:
   \   000044   7405         MOV     A,#0x5
   \   000046   6C           XRL     A,R4
   \   000047   600A         JZ      ??MT_UtilCallbackSub_4
   \   000049   74FF         MOV     A,#-0x1
   \   00004B   68           XRL     A,R0
   \   00004C   7003         JNZ     ??MT_UtilCallbackSub_5
   \   00004E   74FF         MOV     A,#-0x1
   \   000050   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_5:
   \   000051   7036         JNZ     ??MT_UtilCallbackSub_6
    530                _zdoCallbackSub = 0xFFFFFFFF;
   \                     ??MT_UtilCallbackSub_4:
   \   000053   90....       MOV     DPTR,#__Constant_ffffffff
   \   000056   8028         SJMP    ??MT_UtilCallbackSub_7
    531            #endif
    532          
    533            #if defined( MT_AF_CB_FUNC )
    534              if ((subSystem == MT_RPC_SYS_AF) || (subscribed_command == 0xFFFF))
    535                _afCallbackSub = 0xFFFF;
    536            #endif
    537          
    538            #if defined( MT_SAPI_CB_FUNC )
    539              if ((subSystem == MT_RPC_SYS_SAPI) || (subscribed_command == 0xFFFF))
    540                _sapiCallbackSub = 0xFFFF;
    541            #endif
    542            }
    543            else
    544            {
    545              /* Turn OFF */
    546            #if defined( MT_MAC_CB_FUNC )
    547              if ((subSystem == MT_RPC_SYS_MAC) || (subscribed_command == 0xFFFF))
    548                _macCallbackSub = 0x0000;
    549            #endif
    550          
    551            #if defined( MT_NWK_CB_FUNC )
    552              if ((subSystem == MT_RPC_SYS_NWK) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_0:
   \   000058   7403         MOV     A,#0x3
   \   00005A   6C           XRL     A,R4
   \   00005B   600A         JZ      ??MT_UtilCallbackSub_8
   \   00005D   74FF         MOV     A,#-0x1
   \   00005F   68           XRL     A,R0
   \   000060   7003         JNZ     ??MT_UtilCallbackSub_9
   \   000062   74FF         MOV     A,#-0x1
   \   000064   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_9:
   \   000065   7007         JNZ     ??MT_UtilCallbackSub_10
    553                _nwkCallbackSub = 0x0000;
   \                     ??MT_UtilCallbackSub_8:
   \   000067   90....       MOV     DPTR,#_nwkCallbackSub
   \   00006A   E4           CLR     A
   \   00006B   F0           MOVX    @DPTR,A
   \   00006C   A3           INC     DPTR
   \   00006D   F0           MOVX    @DPTR,A
    554            #endif
    555          
    556            #if defined( MT_ZDO_CB_FUNC )
    557              if ((subSystem == MT_RPC_SYS_ZDO) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_10:
   \   00006E   7405         MOV     A,#0x5
   \   000070   6C           XRL     A,R4
   \   000071   600A         JZ      ??MT_UtilCallbackSub_11
   \   000073   74FF         MOV     A,#-0x1
   \   000075   68           XRL     A,R0
   \   000076   7003         JNZ     ??MT_UtilCallbackSub_12
   \   000078   74FF         MOV     A,#-0x1
   \   00007A   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_12:
   \   00007B   700C         JNZ     ??MT_UtilCallbackSub_6
    558                _zdoCallbackSub = 0x00000000;
   \                     ??MT_UtilCallbackSub_11:
   \   00007D   90....       MOV     DPTR,#__Constant_0
   \                     ??MT_UtilCallbackSub_7:
   \   000080   12....       LCALL   ?XLOAD_R2345
   \   000083   90....       MOV     DPTR,#_zdoCallbackSub
   \   000086   12....       LCALL   ?XSTORE_R2345
    559            #endif
    560          
    561            #if defined( MT_AF_CB_FUNC )
    562              if ((subSystem == MT_RPC_SYS_AF) || (subscribed_command == 0xFFFF))
    563                _afCallbackSub = 0x0000;
    564            #endif
    565          
    566            #if defined( MT_SAPI_CB_FUNC )
    567              if ((subSystem == MT_RPC_SYS_SAPI) || (subscribed_command == 0xFFFF))
    568                  _sapiCallbackSub = 0x0000;
    569            #endif
    570            }
    571          #endif  // MT_MAC_CB_FUNC || MT_NWK_CB_FUNC || MT_ZDO_CB_FUNC || MT_AF_CB_FUNC || MT_SAPI_CB_FUNC || MT_SAPI_CB_FUNC
    572          
    573            /* Build and send back the response */
    574            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   \                     ??MT_UtilCallbackSub_6:
   \   000089                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000089                REQUIRE ?Subroutine2
   \   000089                ; // Fall through to label ?Subroutine2
    575          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   AC82         MOV     R4,DPL
   \   000008   AD83         MOV     R5,DPH
   \   00000A   7B01         MOV     R3,#0x1
   \   00000C   EE           MOV     A,R6
   \   00000D   FA           MOV     R2,A
   \   00000E   7967         MOV     R1,#0x67
   \   000010   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   000013   7401         MOV     A,#0x1
   \   000015   12....       LCALL   ?DEALLOC_XSTACK8
   \   000018   7F01         MOV     R7,#0x1
   \   00001A   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   8A82         MOV     DPL,R2
   \   000002   8B83         MOV     DPH,R3
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FE           MOV     R6,A
   \   000008                ; Setup parameters for call to function APSME_LinkKeyDataGet
   \   000008   85..82       MOV     DPL,?XSP + 0
   \   00000B   85..83       MOV     DPH,?XSP + 1
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_33:
   \   000003   22           RET
    576          
    577          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    578          /***************************************************************************************************
    579           * @fn      MT_UtilKeyEvent
    580           *
    581           * @brief   Process Key Event
    582           *
    583           * @param   byte *msg - pointer to the data
    584           *
    585           * @return  void
    586           ***************************************************************************************************/
    587          void MT_UtilKeyEvent(uint8 *pBuf)
    588          {
    589            uint8 x = 0;
    590            uint8 retValue = ZFailure;
    591            uint8 cmdId;
    592          
    593            /* parse header */
    594            cmdId = pBuf[MT_RPC_POS_CMD1];
    595            pBuf += MT_RPC_FRAME_HDR_SZ;
    596          
    597            /* Translate between SPI values to device values */
    598            if ( *pBuf & 0x01 )
    599              x |= HAL_KEY_SW_1;
    600            if ( *pBuf & 0x02 )
    601              x |= HAL_KEY_SW_2;
    602            if ( *pBuf & 0x04 )
    603              x |= HAL_KEY_SW_3;
    604            if ( *pBuf & 0x08 )
    605            x |= HAL_KEY_SW_4;
    606          #if defined ( HAL_KEY_SW_5 )
    607            if ( *pBuf & 0x10 )
    608              x |= HAL_KEY_SW_5;
    609          #endif
    610          #if defined ( HAL_KEY_SW_6 )
    611            if ( *pBuf & 0x20 )
    612              x |= HAL_KEY_SW_6;
    613          #endif
    614          #if defined ( HAL_KEY_SW_7 )
    615            if ( *pBuf & 0x40 )
    616              x |= HAL_KEY_SW_7;
    617          #endif
    618          #if defined ( HAL_KEY_SW_8 )
    619            if ( *pBuf & 0x80 )
    620              x |= HAL_KEY_SW_8;
    621          #endif
    622            pBuf++;
    623          
    624            retValue = OnBoard_SendKeys(x, *pBuf);
    625          
    626            /* Build and send back the response */
    627            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    628          }
    629          #endif
    630          
    631          #if (defined HAL_LED) && (HAL_LED == TRUE)
    632          /***************************************************************************************************
    633           * @fn      MT_UtilLedControl
    634           *
    635           * @brief   Process the LED Control Message
    636           *
    637           * @param   pBuf - pointer to the received data
    638           *
    639           * @return  None
    640           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    641          void MT_UtilLedControl(uint8 *pBuf)
   \                     MT_UtilLedControl:
    642          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    643            uint8 iLed, Led, iMode, Mode, cmdId;
    644            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine4 & 0xFFFF
    645          
    646            /* parse header */
    647            cmdId = pBuf[MT_RPC_POS_CMD1];
    648            pBuf += MT_RPC_FRAME_HDR_SZ;
    649          
    650            /* LED and Mode */
    651            iLed = *pBuf++;
   \                     ??CrossCallReturnLabel_2:
   \   00000D   F8           MOV     R0,A
   \   00000E   A3           INC     DPTR
    652            iMode = *pBuf;
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   FA           MOV     R2,A
    653          
    654            if ( iLed == 1 )
   \   000011   7401         MOV     A,#0x1
   \   000013   68           XRL     A,R0
   \   000014   7004         JNZ     ??MT_UtilLedControl_0
    655              Led = HAL_LED_1;
   \   000016   7901         MOV     R1,#0x1
   \   000018   8026         SJMP    ??MT_UtilLedControl_1
    656            else if ( iLed == 2 )
   \                     ??MT_UtilLedControl_0:
   \   00001A   7402         MOV     A,#0x2
   \   00001C   68           XRL     A,R0
   \   00001D   7004         JNZ     ??MT_UtilLedControl_2
    657              Led = HAL_LED_2;
   \   00001F   7902         MOV     R1,#0x2
   \   000021   801D         SJMP    ??MT_UtilLedControl_1
    658            else if ( iLed == 3 )
   \                     ??MT_UtilLedControl_2:
   \   000023   7403         MOV     A,#0x3
   \   000025   68           XRL     A,R0
   \   000026   7004         JNZ     ??MT_UtilLedControl_3
    659              Led = HAL_LED_3;
   \   000028   7904         MOV     R1,#0x4
   \   00002A   8014         SJMP    ??MT_UtilLedControl_1
    660            else if ( iLed == 4 )
   \                     ??MT_UtilLedControl_3:
   \   00002C   7404         MOV     A,#0x4
   \   00002E   68           XRL     A,R0
   \   00002F   7004         JNZ     ??MT_UtilLedControl_4
    661              Led = HAL_LED_4;
   \   000031   7908         MOV     R1,#0x8
   \   000033   800B         SJMP    ??MT_UtilLedControl_1
    662            else if ( iLed == 0xFF )
   \                     ??MT_UtilLedControl_4:
   \   000035   74FF         MOV     A,#-0x1
   \   000037   68           XRL     A,R0
   \   000038   7004         JNZ     ??MT_UtilLedControl_5
    663              Led = HAL_LED_ALL;
   \   00003A   790F         MOV     R1,#0xf
   \   00003C   8002         SJMP    ??MT_UtilLedControl_1
    664            else
    665              Led = 0;
   \                     ??MT_UtilLedControl_5:
   \   00003E   7900         MOV     R1,#0x0
    666          
    667            if ( iMode == 0 )
   \                     ??MT_UtilLedControl_1:
   \   000040   EA           MOV     A,R2
   \   000041   7004         JNZ     ??MT_UtilLedControl_6
    668              Mode = HAL_LED_MODE_OFF;
   \   000043   7A00         MOV     R2,#0x0
   \   000045   8022         SJMP    ??MT_UtilLedControl_7
    669            else if ( iMode == 1 )
   \                     ??MT_UtilLedControl_6:
   \   000047   7401         MOV     A,#0x1
   \   000049   6A           XRL     A,R2
   \   00004A   7004         JNZ     ??MT_UtilLedControl_8
    670              Mode = HAL_LED_MODE_ON;
   \   00004C   7A01         MOV     R2,#0x1
   \   00004E   8019         SJMP    ??MT_UtilLedControl_7
    671            else if ( iMode == 2 )
   \                     ??MT_UtilLedControl_8:
   \   000050   7402         MOV     A,#0x2
   \   000052   6A           XRL     A,R2
   \   000053   7004         JNZ     ??MT_UtilLedControl_9
    672              Mode = HAL_LED_MODE_BLINK;
   \   000055   7A02         MOV     R2,#0x2
   \   000057   8010         SJMP    ??MT_UtilLedControl_7
    673            else if ( iMode == 3 )
   \                     ??MT_UtilLedControl_9:
   \   000059   7403         MOV     A,#0x3
   \   00005B   6A           XRL     A,R2
   \   00005C   7004         JNZ     ??MT_UtilLedControl_10
    674              Mode = HAL_LED_MODE_FLASH;
   \   00005E   7A04         MOV     R2,#0x4
   \   000060   8007         SJMP    ??MT_UtilLedControl_7
    675            else if ( iMode == 4 )
   \                     ??MT_UtilLedControl_10:
   \   000062   7404         MOV     A,#0x4
   \   000064   6A           XRL     A,R2
   \   000065   7010         JNZ     ??MT_UtilLedControl_11
    676              Mode = HAL_LED_MODE_TOGGLE;
   \   000067   7A08         MOV     R2,#0x8
    677            else
    678              Led = 0;
    679          
    680            if ( Led != 0 )
   \                     ??MT_UtilLedControl_7:
   \   000069   E9           MOV     A,R1
   \   00006A   600B         JZ      ??MT_UtilLedControl_11
    681            {
    682              HalLedSet (Led, Mode);
   \   00006C                ; Setup parameters for call to function HalLedSet
   \   00006C   12....       LCALL   ??HalLedSet?relay
    683              retValue = ZSuccess;
   \   00006F   85..82       MOV     DPL,?XSP + 0
   \   000072   85..83       MOV     DPH,?XSP + 1
   \   000075   E4           CLR     A
   \   000076   F0           MOVX    @DPTR,A
    684            }
    685          
    686            /* Build and send back the response */
    687            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   \                     ??MT_UtilLedControl_11:
   \   000077                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000077   02....       LJMP    ?Subroutine2 & 0xFFFF
    688          
    689          }
    690          #endif /* HAL_LED */
    691          
    692          /***************************************************************************************************
    693           * @fn      MT_UtilTimeAlive
    694           *
    695           * @brief   Process Time Alive
    696           *
    697           * @param   pBuf - pointer to the received data
    698           *
    699           * @return  None
    700           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    701          void MT_UtilTimeAlive(void)
   \                     MT_UtilTimeAlive:
    702          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 4
   \   000005   74FC         MOV     A,#-0x4
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    703            uint8 timeAlive[4];
    704            uint32 tmp32;
    705          
    706            /* Time since last reset (seconds) */
    707            tmp32 = osal_GetSystemClock() / 1000;
   \   00000A                ; Setup parameters for call to function osal_GetSystemClock
   \   00000A   12....       LCALL   ??osal_GetSystemClock?relay
   \   00000D   8A..         MOV     ?V0 + 4,R2
   \   00000F   8B..         MOV     ?V0 + 5,R3
   \   000011   8C..         MOV     ?V0 + 6,R4
   \   000013   8D..         MOV     ?V0 + 7,R5
   \   000015   90....       MOV     DPTR,#__Constant_3e8
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?L_MOV_X
   \   00001D   78..         MOV     R0,#?V0 + 4
   \   00001F   79..         MOV     R1,#?V0 + 0
   \   000021   12....       LCALL   ?UL_DIV_MOD
    708          
    709            /* Convert to high byte first into temp buffer */
    710            timeAlive[0] = BREAK_UINT32(tmp32, 0);
   \   000024   85..82       MOV     DPL,?XSP + 0
   \   000027   85..83       MOV     DPH,?XSP + 1
   \   00002A   E5..         MOV     A,?V0 + 4
   \   00002C   F0           MOVX    @DPTR,A
    711            timeAlive[1] = BREAK_UINT32(tmp32, 1);
   \   00002D   85....       MOV     ?V0 + 1,?V0 + 5
   \   000030   E5..         MOV     A,?V0 + 1
   \   000032   F5..         MOV     ?V0 + 0,A
   \   000034   7401         MOV     A,#0x1
   \   000036   12....       LCALL   ?XSTACK_DISP0_8
   \   000039   E5..         MOV     A,?V0 + 0
   \   00003B   F0           MOVX    @DPTR,A
    712            timeAlive[2] = BREAK_UINT32(tmp32, 2);
   \   00003C   85....       MOV     ?V0 + 0,?V0 + 4
   \   00003F   85....       MOV     ?V0 + 2,?V0 + 6
   \   000042   85....       MOV     ?V0 + 3,?V0 + 7
   \   000045   7410         MOV     A,#0x10
   \   000047   78..         MOV     R0,#?V0 + 0
   \   000049   12....       LCALL   ?UL_SHR
   \   00004C   7402         MOV     A,#0x2
   \   00004E   12....       LCALL   ?XSTACK_DISP0_8
   \   000051   E5..         MOV     A,?V0 + 0
   \   000053   F0           MOVX    @DPTR,A
    713            timeAlive[3] = BREAK_UINT32(tmp32, 3);
   \   000054   7418         MOV     A,#0x18
   \   000056   78..         MOV     R0,#?V0 + 4
   \   000058   12....       LCALL   ?UL_SHR
   \   00005B   7403         MOV     A,#0x3
   \   00005D   12....       LCALL   ?XSTACK_DISP0_8
   \   000060   E5..         MOV     A,?V0 + 4
   \   000062   12....       LCALL   ??Subroutine22_0 & 0xFFFF
    714          
    715            /* Build and send back the response */
    716            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), MT_UTIL_TIME_ALIVE,
    717                                         sizeof(tmp32), timeAlive );
   \                     ??CrossCallReturnLabel_46:
   \   000065   7B04         MOV     R3,#0x4
   \   000067   7A09         MOV     R2,#0x9
   \   000069   7967         MOV     R1,#0x67
   \   00006B   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    718          }
   \   00006E   7404         MOV     A,#0x4
   \   000070   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine22_0:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   AC82         MOV     R4,DPL
   \   000009   AD83         MOV     R5,DPH
   \   00000B   22           RET
    719          
    720          /***************************************************************************************************
    721           * @fn      MT_UtilAddrMgrExtAddrLookup
    722           *
    723           * @brief   Proxy the AddrMgrExtAddrLookup() function.
    724           *
    725           * @param   pBuf - pointer to the received buffer
    726           *
    727           * @return  void
    728           ***************************************************************************************************/
    729          static void MT_UtilAddrMgrExtAddrLookup(uint8 *pBuf)
    730          {
    731            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
    732            pBuf += MT_RPC_FRAME_HDR_SZ;
    733          
    734            (void)AddrMgrExtAddrLookup(BUILD_UINT16(pBuf[Z_EXTADDR_LEN], pBuf[Z_EXTADDR_LEN+1]), pBuf);
    735            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId,
    736                                                                         Z_EXTADDR_LEN, (uint8 *)pBuf);
    737          }
    738          
    739          /***************************************************************************************************
    740           * @fn      MT_UtilAddrMgrEntryLookupNwk
    741           *
    742           * @brief   Proxy the AddrMgrEntryLookupNwk() function.
    743           *
    744           * @param   pBuf - pointer to the received buffer
    745           *
    746           * @return  void
    747           ***************************************************************************************************/
    748          static void MT_UtilAddrMgrEntryLookupNwk(uint8 *pBuf)
    749          {
    750            AddrMgrEntry_t entry;
    751            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
    752            pBuf += MT_RPC_FRAME_HDR_SZ;
    753          
    754            entry.nwkAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
    755            (void)AddrMgrEntryLookupNwk(&entry);
    756            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId,
    757                                                                            Z_EXTADDR_LEN, entry.extAddr);
    758          }
    759          
    760          /***************************************************************************************************
    761           * @fn      MT_UtilAPSME_LinkKeyDataGet
    762           *
    763           * @brief   Proxy the APSME_LinkKeyDataGet() function.
    764           *
    765           * @param   pBuf - pointer to the received buffer
    766           *
    767           * @return  void
    768           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    769          static void MT_UtilAPSME_LinkKeyDataGet(uint8 *pBuf)
   \                     MT_UtilAPSME_LinkKeyDataGet:
    770          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 27
   \   000005   74E5         MOV     A,#-0x1b
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    771            // Status + LinkKeyDataLen + Tx+Rx Frame counter.
    772            #define MT_APSME_LINKKEY_GET_RSP_LEN (1 + SEC_KEY_LEN + 4 + 4)
    773            uint8 rsp[MT_APSME_LINKKEY_GET_RSP_LEN];
    774            APSME_LinkKeyData_t *pData;
    775            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   12....       LCALL   ?Subroutine9 & 0xFFFF
    776            pBuf += MT_RPC_FRAME_HDR_SZ;
    777          
    778            *rsp = APSME_LinkKeyDataGet(pBuf, &pData);
   \                     ??CrossCallReturnLabel_13:
   \   00000D   AC82         MOV     R4,DPL
   \   00000F   AD83         MOV     R5,DPH
   \   000011   12....       LCALL   ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   000014   12....       LCALL   ??APSME_LinkKeyDataGet?relay
   \   000017   7402         MOV     A,#0x2
   \   000019   12....       LCALL   ?XSTACK_DISP0_8
   \   00001C   E9           MOV     A,R1
   \   00001D   F0           MOVX    @DPTR,A
    779          
    780            if (SUCCESS == *rsp)
   \   00001E   6003         JZ      $+5
   \   000020   02....       LJMP    ??MT_UtilAPSME_LinkKeyDataGet_0 & 0xFFFF
    781            {
    782              uint8 *ptr = rsp+1;
    783              (void)osal_memcpy(ptr, pData->key, SEC_KEY_LEN);
   \   000023                ; Setup parameters for call to function osal_memcpy
   \   000023   85..82       MOV     DPL,?XSP + 0
   \   000026   85..83       MOV     DPH,?XSP + 1
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F8           MOV     R0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F583         MOV     DPH,A
   \   00002F   8882         MOV     DPL,R0
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F5..         MOV     ?V0 + 0,A
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F5..         MOV     ?V0 + 1,A
   \   000038   75..00       MOV     ?V0 + 2,#0x0
   \   00003B   78..         MOV     R0,#?V0 + 0
   \   00003D   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000040   7C10         MOV     R4,#0x10
   \   000042   7D00         MOV     R5,#0x0
   \   000044   7406         MOV     A,#0x6
   \   000046   12....       LCALL   ?XSTACK_DISP0_8
   \   000049   AA82         MOV     R2,DPL
   \   00004B   AB83         MOV     R3,DPH
   \   00004D   12....       LCALL   ??osal_memcpy?relay
   \   000050   7403         MOV     A,#0x3
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
    784              ptr += SEC_KEY_LEN;
    785              *ptr++ = BREAK_UINT32(pData->txFrmCntr, 0);
   \   000055   85..82       MOV     DPL,?XSP + 0
   \   000058   85..83       MOV     DPH,?XSP + 1
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   2402         ADD     A,#0x2
   \   00005E   12....       LCALL   ?Subroutine7 & 0xFFFF
    786              *ptr++ = BREAK_UINT32(pData->txFrmCntr, 1);
    787              *ptr++ = BREAK_UINT32(pData->txFrmCntr, 2);
    788              *ptr++ = BREAK_UINT32(pData->txFrmCntr, 3);
    789              *ptr++ = BREAK_UINT32(pData->rxFrmCntr, 0);
    790              *ptr++ = BREAK_UINT32(pData->rxFrmCntr, 1);
    791              *ptr++ = BREAK_UINT32(pData->rxFrmCntr, 2);
    792              *ptr++ = BREAK_UINT32(pData->rxFrmCntr, 3);
    793            }
   \                     ??CrossCallReturnLabel_8:
   \   000061   12....       LCALL   ?L_MOV_X
   \   000064   7413         MOV     A,#0x13
   \   000066   12....       LCALL   ?XSTACK_DISP0_8
   \   000069   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   00006C   12....       LCALL   ?L_MOV_X
   \   00006F   E5..         MOV     A,?V0 + 1
   \   000071   F5..         MOV     ?V0 + 0,A
   \   000073   7414         MOV     A,#0x14
   \   000075   12....       LCALL   ?XSTACK_DISP0_8
   \   000078   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   00007B   12....       LCALL   ?L_MOV_X
   \   00007E   7410         MOV     A,#0x10
   \   000080   78..         MOV     R0,#?V0 + 0
   \   000082   12....       LCALL   ?UL_SHR
   \   000085   7415         MOV     A,#0x15
   \   000087   12....       LCALL   ?XSTACK_DISP0_8
   \   00008A   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   00008D   12....       LCALL   ?L_MOV_X
   \   000090   7418         MOV     A,#0x18
   \   000092   78..         MOV     R0,#?V0 + 0
   \   000094   12....       LCALL   ?UL_SHR
   \   000097   7416         MOV     A,#0x16
   \   000099   12....       LCALL   ?XSTACK_DISP0_8
   \   00009C   E5..         MOV     A,?V0 + 0
   \   00009E   12....       LCALL   ?Subroutine15 & 0xFFFF
   \                     ??CrossCallReturnLabel_29:
   \   0000A1   E0           MOVX    A,@DPTR
   \   0000A2   2406         ADD     A,#0x6
   \   0000A4   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   0000A7   12....       LCALL   ?L_MOV_X
   \   0000AA   7417         MOV     A,#0x17
   \   0000AC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AF   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_20:
   \   0000B2   12....       LCALL   ?L_MOV_X
   \   0000B5   E5..         MOV     A,?V0 + 1
   \   0000B7   F5..         MOV     ?V0 + 0,A
   \   0000B9   7418         MOV     A,#0x18
   \   0000BB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000BE   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   0000C1   12....       LCALL   ?L_MOV_X
   \   0000C4   7410         MOV     A,#0x10
   \   0000C6   78..         MOV     R0,#?V0 + 0
   \   0000C8   12....       LCALL   ?UL_SHR
   \   0000CB   7419         MOV     A,#0x19
   \   0000CD   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D0   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   0000D3   12....       LCALL   ?L_MOV_X
   \   0000D6   7418         MOV     A,#0x18
   \   0000D8   78..         MOV     R0,#?V0 + 0
   \   0000DA   12....       LCALL   ?UL_SHR
   \   0000DD   741A         MOV     A,#0x1a
   \   0000DF   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E2   E5..         MOV     A,?V0 + 0
   \   0000E4   F0           MOVX    @DPTR,A
    794          
    795            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 
    796                                                 MT_APSME_LINKKEY_GET_RSP_LEN, rsp);
   \                     ??MT_UtilAPSME_LinkKeyDataGet_0:
   \   0000E5                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000E5   7402         MOV     A,#0x2
   \   0000E7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EA   AC82         MOV     R4,DPL
   \   0000EC   AD83         MOV     R5,DPH
   \   0000EE   7B19         MOV     R3,#0x19
   \   0000F0   EE           MOV     A,R6
   \   0000F1   FA           MOV     R2,A
   \   0000F2   7963         MOV     R1,#0x63
   \   0000F4   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    797          }
   \   0000F7   741B         MOV     A,#0x1b
   \   0000F9                REQUIRE ?Subroutine3
   \   0000F9                ; // Fall through to label ?Subroutine3

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F04         MOV     R7,#0x4
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   E5..         MOV     A,?V0 + 0
   \   000002   F0           MOVX    @DPTR,A
   \   000003   8A82         MOV     DPL,R2
   \   000005   8B83         MOV     DPH,R3
   \   000007   78..         MOV     R0,#?V0 + 0
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   F8           MOV     R0,A
   \   000001   A3           INC     DPTR
   \   000002   E0           MOVX    A,@DPTR
   \   000003   3400         ADDC    A,#0x0
   \   000005   F9           MOV     R1,A
   \   000006   E8           MOV     A,R0
   \   000007   FA           MOV     R2,A
   \   000008   E9           MOV     A,R1
   \   000009   FB           MOV     R3,A
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   78..         MOV     R0,#?V0 + 0
   \   000010   22           RET
    798          
    799          /***************************************************************************************************
    800           * @fn      MT_UtilAssocCount
    801           *
    802           * @brief   Proxy the AssocCount() function.
    803           *
    804           * @param   pBuf - pointer to the received buffer
    805           *
    806           * @return  void
    807           ***************************************************************************************************/
    808          static void MT_UtilAssocCount(uint8 *pBuf)
    809          {
    810            uint16 cnt;
    811            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
    812            pBuf += MT_RPC_FRAME_HDR_SZ;
    813            
    814            cnt = AssocCount(pBuf[0], pBuf[1]);
    815            pBuf[0] = LO_UINT16(cnt);
    816            pBuf[1] = HI_UINT16(cnt);
    817          
    818            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 2, pBuf);
    819          }
    820          
    821          /***************************************************************************************************
    822           * @fn      MT_UtilAssocFindDevice
    823           *
    824           * @brief   Get an associated device by index.
    825           *
    826           * @param   pBuf - pointer to the received buffer
    827           *
    828           * @return  void
    829           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    830          static void MT_UtilAssocFindDevice(uint8 *pBuf)
   \                     MT_UtilAssocFindDevice:
    831          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 18
   \   000005   74EE         MOV     A,#-0x12
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    832            associated_devices_t *pDev;
    833            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   FE           MOV     R6,A
    834          
    835            pDev = AssocFindDevice(pBuf[MT_RPC_FRAME_HDR_SZ]);
   \   000012                ; Setup parameters for call to function AssocFindDevice
   \   000012   8A82         MOV     DPL,R2
   \   000014   8B83         MOV     DPH,R3
   \   000016   A3           INC     DPTR
   \   000017   A3           INC     DPTR
   \   000018   A3           INC     DPTR
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F9           MOV     R1,A
   \   00001B   12....       LCALL   ??AssocFindDevice?relay
   \   00001E   8A..         MOV     ?V0 + 0,R2
   \   000020   8B..         MOV     ?V0 + 1,R3
   \   000022   AC..         MOV     R4,?V0 + 0
   \   000024   AD..         MOV     R5,?V0 + 1
    836          
    837            if (NULL != pDev)
   \   000026   EC           MOV     A,R4
   \   000027   4D           ORL     A,R5
   \   000028   7003         JNZ     ??CrossCallReturnLabel_44
    838            {
    839              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId,
    840                                             sizeof(associated_devices_t), (uint8 *)pDev);
   \   00002A                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
    841            }
    842            else
    843            {
    844              associated_devices_t dev;
    845          
    846              dev.shortAddr = INVALID_NODE_ADDR;
   \   00002A   12....       LCALL   ?Subroutine13 & 0xFFFF
    847              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId,
    848                                             sizeof(associated_devices_t), (uint8 *)(&dev));
    849            }
   \                     ??CrossCallReturnLabel_44:
   \   00002D   7B12         MOV     R3,#0x12
   \   00002F   EE           MOV     A,R6
   \   000030   FA           MOV     R2,A
   \   000031   7963         MOV     R1,#0x63
   \   000033   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    850          }
   \   000036   7412         MOV     A,#0x12
   \   000038   02....       LJMP    ??Subroutine21_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   74FE         MOV     A,#-0x2
   \   000008   F0           MOVX    @DPTR,A
   \   000009   A3           INC     DPTR
   \   00000A   04           INC     A
   \   00000B                REQUIRE ??Subroutine22_0
   \   00000B                ; // Fall through to label ??Subroutine22_0
    851          
    852          /***************************************************************************************************
    853           * @fn      MT_UtilAssocGetWithAddress
    854           *
    855           * @brief   Get an associated device by address.
    856           *
    857           * @param   pBuf - pointer to the received buffer
    858           *
    859           * @return  void
    860           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    861          static void MT_UtilAssocGetWithAddress(uint8 *pBuf)
   \                     MT_UtilAssocGetWithAddress:
    862          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 18
   \   000005   74EE         MOV     A,#-0x12
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    863            extern associated_devices_t *AssocGetWithAddress(uint8 *extAddr, uint16 shortAddr);
    864            associated_devices_t *pDev;
    865            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000E   8E82         MOV     DPL,R6
   \   000010   8F83         MOV     DPH,R7
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 0,A
    866          
    867            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000017   EE           MOV     A,R6
   \   000018   2403         ADD     A,#0x3
   \   00001A   0E           INC     R6
   \   00001B   0E           INC     R6
   \   00001C   0E           INC     R6
   \   00001D   EF           MOV     A,R7
   \   00001E   3400         ADDC    A,#0x0
   \   000020   FF           MOV     R7,A
    868            pDev = AssocGetWithAddress(((AddrMgrExtAddrValid(pBuf)) ? pBuf : NULL),
    869                                         BUILD_UINT16(pBuf[Z_EXTADDR_LEN], pBuf[Z_EXTADDR_LEN+1]));
   \   000021                ; Setup parameters for call to function AddrMgrExtAddrValid
   \   000021   0A           INC     R2
   \   000022   0A           INC     R2
   \   000023   0A           INC     R2
   \   000024   FB           MOV     R3,A
   \   000025   12....       LCALL   ??AddrMgrExtAddrValid?relay
   \   000028   E9           MOV     A,R1
   \   000029   6006         JZ      ??MT_UtilAssocGetWithAddress_0
   \   00002B   EE           MOV     A,R6
   \   00002C   FA           MOV     R2,A
   \   00002D   EF           MOV     A,R7
   \   00002E   FB           MOV     R3,A
   \   00002F   8004         SJMP    ??MT_UtilAssocGetWithAddress_1
   \                     ??MT_UtilAssocGetWithAddress_0:
   \   000031   7A00         MOV     R2,#0x0
   \   000033   7B00         MOV     R3,#0x0
   \                     ??MT_UtilAssocGetWithAddress_1:
   \   000035                ; Setup parameters for call to function AssocGetWithAddress
   \   000035   8E82         MOV     DPL,R6
   \   000037   8F83         MOV     DPH,R7
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   FC           MOV     R4,A
   \   000043   8E82         MOV     DPL,R6
   \   000045   8F83         MOV     DPH,R7
   \   000047   A3           INC     DPTR
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   A3           INC     DPTR
   \   00004E   A3           INC     DPTR
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   F9           MOV     R1,A
   \   000052   EC           MOV     A,R4
   \   000053   2400         ADD     A,#0x0
   \   000055   E4           CLR     A
   \   000056   39           ADDC    A,R1
   \   000057   FD           MOV     R5,A
   \   000058   12....       LCALL   ??AssocGetWithAddress?relay
   \   00005B   8A..         MOV     ?V0 + 2,R2
   \   00005D   8B..         MOV     ?V0 + 3,R3
   \   00005F   AC..         MOV     R4,?V0 + 2
   \   000061   AD..         MOV     R5,?V0 + 3
    870          
    871            if (NULL != pDev)
   \   000063   EC           MOV     A,R4
   \   000064   4D           ORL     A,R5
   \   000065   7003         JNZ     ??CrossCallReturnLabel_45
    872            {
    873              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId,
    874                                             sizeof(associated_devices_t), (uint8 *)pDev);
   \   000067                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
    875            }
    876            else
    877            {
    878              associated_devices_t dev;
    879          
    880              dev.shortAddr = INVALID_NODE_ADDR;
   \   000067   12....       LCALL   ?Subroutine13 & 0xFFFF
    881              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId,
    882                                             sizeof(associated_devices_t), (uint8 *)(&dev));
    883            }
   \                     ??CrossCallReturnLabel_45:
   \   00006A   7B12         MOV     R3,#0x12
   \   00006C   AA..         MOV     R2,?V0 + 0
   \   00006E   7963         MOV     R1,#0x63
   \   000070   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    884          }
   \   000073   7412         MOV     A,#0x12
   \   000075   02....       LJMP    ?Subroutine3 & 0xFFFF

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_ffffffff:
   \   000000   FFFFFFFF     DD 4294967295

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_0:
   \   000000   00000000     DD 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilCommandProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilCommandProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilGetDeviceInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilGetDeviceInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilGetNvInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilGetNvInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetPanID?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetPanID

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetChannels?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetChannels

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetSecLevel?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetSecLevel

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetPreCfgKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetPreCfgKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilCallbackSub?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilCallbackSub

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilLedControl?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilLedControl

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilTimeAlive?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilTimeAlive

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAPSME_LinkKeyDataGet?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAPSME_LinkKeyDataGet

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAssocFindDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAssocFindDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAssocGetWithAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAssocGetWithAddress
    885          
    886          #if defined ZCL_KEY_ESTABLISH
    887          /***************************************************************************************************
    888           * @fn      MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment
    889           *
    890           * @brief   Proxy the zclGeneral_KeyEstablish_InitiateKeyEstablishment() function.
    891           *
    892           * @param   pBuf - pointer to the received buffer
    893           *
    894           * @return  void
    895           ***************************************************************************************************/
    896          static void MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(uint8 *pBuf)
    897          {
    898            afAddrType_t partnerAddr;
    899            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
    900            pBuf += MT_RPC_FRAME_HDR_SZ;
    901          
    902            partnerAddr.panId = 0;  // Not an inter-pan message.
    903            partnerAddr.endPoint = pBuf[2];
    904            partnerAddr.addrMode = (afAddrMode_t)pBuf[3];
    905            if (afAddr64Bit == partnerAddr.addrMode)
    906            {
    907              (void)osal_memcpy(partnerAddr.addr.extAddr, pBuf+4, Z_EXTADDR_LEN);
    908            }
    909            else
    910            {
    911              partnerAddr.addr.shortAddr = BUILD_UINT16(pBuf[4], pBuf[4]);
    912            }
    913          
    914            zcl_key_establish_task_id = pBuf[0];
    915            *pBuf = zclGeneral_KeyEstablish_InitiateKeyEstablishment(MT_TaskID, &partnerAddr, pBuf[1]);
    916            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, pBuf);
    917          }
    918          
    919          /***************************************************************************************************
    920           * @fn      MT_UtilzclGeneral_KeyEstablishment_ECDSASign
    921           *
    922           * @brief   Proxy the zclGeneral_KeyEstablishment_ECDSASign() function.
    923           *
    924           * @param   pBuf - pointer to the received buffer
    925           *
    926           * @return  void
    927           ***************************************************************************************************/
    928          static void MT_UtilzclGeneral_KeyEstablishment_ECDSASign(uint8 *pBuf)
    929          {
    930          #if defined TC_LINKKEY_JOIN
    931            uint8 *output = osal_mem_alloc(SE_PROFILE_SIGNATURE_LENGTH+1);
    932            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
    933            pBuf += MT_RPC_FRAME_HDR_SZ;
    934          
    935            if (NULL == output)
    936            {
    937              *pBuf = FAILURE;
    938              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, pBuf);
    939            }
    940            else
    941            {
    942              *output = zclGeneral_KeyEstablishment_ECDSASign(pBuf+1, *pBuf, output+1);
    943              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
    944                                                   SE_PROFILE_SIGNATURE_LENGTH+1, output);
    945              osal_mem_free(output);
    946            }
    947          #endif
    948          }
    949          
    950          /***************************************************************************************************
    951           * @fn      MT_UtilKeyEstablishInd
    952           *
    953           * @brief   Proxy the ZCL_KEY_ESTABLISH_IND command.
    954           *
    955           * @param   None
    956           *
    957           * @return  None
    958           ***************************************************************************************************/
    959          void MT_UtilKeyEstablishInd(keyEstablishmentInd_t *pInd)
    960          {
    961            uint8 msg[6];
    962          
    963            msg[0] = zcl_key_establish_task_id;
    964            msg[1] = pInd->hdr.event;
    965            msg[2] = pInd->hdr.status;
    966            msg[3] = pInd->waitTime;
    967            msg[4] = LO_UINT16(pInd->keyEstablishmentSuite);
    968            msg[5] = HI_UINT16(pInd->keyEstablishmentSuite);
    969          
    970            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_UTIL),
    971                                                 MT_UTIL_ZCL_KEY_ESTABLISH_IND, 6, msg);
    972          }
    973          #endif
    974          
    975          /***************************************************************************************************
    976           * @fn      MT_UtilSync
    977           *
    978           * @brief   Process the MT_UTIL_SYNC command
    979           *
    980           * @param   None
    981           *
    982           * @return  None
    983           ***************************************************************************************************/
    984          static void MT_UtilSync(void)
    985          {
    986           MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ|(uint8)MT_RPC_SYS_UTIL),MT_UTIL_SYNC_REQ,0,0);
    987          }
    988          
    989          #endif /* MT_UTIL_FUNC */
    990          /**************************************************************************************************
    991           **************************************************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     MT_UtilAPSME_LinkKeyDataGet        1      0     71
       -> APSME_LinkKeyDataGet          0      0     78
       -> osal_memcpy                   0      0     84
       -> MT_BuildAndSendZToolResponse
                                        0      0     78
     MT_UtilAssocFindDevice             0      0     57
       -> AssocFindDevice               0      0     56
       -> MT_BuildAndSendZToolResponse
                                        0      0     56
       -> MT_BuildAndSendZToolResponse
                                        0      0     56
     MT_UtilAssocGetWithAddress         0      0     59
       -> AddrMgrExtAddrValid           0      0     60
       -> AssocGetWithAddress           0      0     60
       -> MT_BuildAndSendZToolResponse
                                        0      0     60
       -> MT_BuildAndSendZToolResponse
                                        0      0     60
     MT_UtilCallbackSub                 0      0     39
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_UtilCommandProcessing           1      0     29
       -> MT_UtilGetDeviceInfo          0      0     58
       -> MT_UtilGetNvInfo              0      0     58
       -> MT_UtilSetPanID               0      0     58
       -> MT_UtilSetChannels            0      0     58
       -> MT_UtilSetSecLevel            0      0     58
       -> MT_UtilSetPreCfgKey           0      0     58
       -> MT_UtilCallbackSub            0      0     58
       -> MT_UtilLedControl             0      0     58
       -> MT_UtilTimeAlive              0      0     58
       -> AddrMgrExtAddrLookup          0      0     58
       -> MT_BuildAndSendZToolResponse
                                        0      0     58
       -> AddrMgrEntryLookupNwk         0      0     58
       -> MT_BuildAndSendZToolResponse
                                        0      0     58
       -> MT_UtilAPSME_LinkKeyDataGet
                                        0      0     58
       -> AssocCount                    0      0     58
       -> MT_BuildAndSendZToolResponse
                                        0      0     58
       -> MT_UtilAssocFindDevice        0      0     58
       -> MT_UtilAssocGetWithAddress
                                        0      0     58
       -> MT_BuildAndSendZToolResponse
                                        0      0     58
     MT_UtilGetDeviceInfo               1      0     50
       -> AssocMakeList                 0      0     34
       -> osal_mem_alloc                0      0     34
       -> osal_nv_read                  0      0     42
       -> NLME_GetShortAddr             0      0     34
       -> MT_BuildAndSendZToolResponse
                                        0      0     34
       -> osal_mem_free                 0      0     34
       -> osal_mem_free                 0      0     34
     MT_UtilGetNvInfo                   1      0     55
       -> osal_mem_alloc                0      0     44
       -> osal_memset                   0      0     44
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> MT_BuildAndSendZToolResponse
                                        0      0     44
       -> osal_mem_free                 0      0     44
     MT_UtilLedControl                  0      0     39
       -> HalLedSet                     0      0     20
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_UtilSetChannels                 1      0     54
       -> osal_nv_item_len              0      0     46
       -> osal_nv_write                 0      0     50
       -> MT_BuildAndSendZToolResponse
                                        0      0     42
     MT_UtilSetPanID                    1      0     46
       -> osal_nv_item_len              0      0     30
       -> osal_nv_write                 0      0     34
       -> MT_BuildAndSendZToolResponse
                                        0      0     26
     MT_UtilSetPreCfgKey                1      0     44
       -> osal_nv_item_len              0      0     26
       -> osal_nv_write                 0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     22
     MT_UtilSetSecLevel                 1      0     44
       -> osal_nv_item_len              0      0     26
       -> osal_nv_write                 0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     22
     MT_UtilTimeAlive                   1      0     49
       -> osal_GetSystemClock           0      0     40
       -> MT_BuildAndSendZToolResponse
                                        0      0     40


   Segment part sizes:

     Function/Label                      Bytes
     --------------                      -----
     MT_UtilCommandProcessing             352
     ?Subroutine0                           8
     MT_UtilGetDeviceInfo                 288
     ?Subroutine16                          9
     ?Subroutine14                          6
     ??Subroutine20_0                       8
     ?Subroutine5                          11
     ?Subroutine18                          9
     MT_UtilGetNvInfo                     454
     ?Subroutine15                          8
     MT_UtilSetPanID                       76
     ??Subroutine21_0                       8
     ?Subroutine10                         22
     ?Subroutine4                          12
     ?Subroutine12                         12
     ?Subroutine19                         18
     ?Subroutine17                         11
     MT_UtilSetChannels                   158
     ?Subroutine1                          15
     MT_UtilSetSecLevel                    33
     ?Subroutine6                          16
     MT_UtilSetPreCfgKey                   33
     MT_UtilCallbackSub                   137
     ?Subroutine2                          29
     ?Subroutine9                          15
     ?Subroutine8                           4
     MT_UtilLedControl                    122
     MT_UtilTimeAlive                     115
     ??Subroutine22_0                      12
     MT_UtilAPSME_LinkKeyDataGet          249
     ?Subroutine3                           8
     ?Subroutine11                         10
     ?Subroutine7                          17
     MT_UtilAssocFindDevice                59
     ?Subroutine13                         11
     MT_UtilAssocGetWithAddress           120
     __Constant_ffffffff                    4
     __Constant_0                           4
     __Constant_3e8                         4
     ??MT_UtilCommandProcessing?relay       6
     ??MT_UtilGetDeviceInfo?relay           6
     ??MT_UtilGetNvInfo?relay               6
     ??MT_UtilSetPanID?relay                6
     ??MT_UtilSetChannels?relay             6
     ??MT_UtilSetSecLevel?relay             6
     ??MT_UtilSetPreCfgKey?relay            6
     ??MT_UtilCallbackSub?relay             6
     ??MT_UtilLedControl?relay              6
     ??MT_UtilTimeAlive?relay               6
     ??MT_UtilAPSME_LinkKeyDataGet?relay    6
     ??MT_UtilAssocFindDevice?relay         6
     ??MT_UtilAssocGetWithAddress?relay     6

 
 2 475 bytes in segment BANKED_CODE
    78 bytes in segment BANK_RELAYS
    12 bytes in segment XDATA_ROM_C
 
 2 553 bytes of CODE  memory
     0 bytes of CONST memory (+ 12 bytes shared)

Errors: none
Warnings: none
